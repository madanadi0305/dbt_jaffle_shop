[0m14:19:42.286728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CB73966F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CB7394CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CB6F77470>]}


============================== 14:19:42.290724 | 0cb20113-b074-4310-8e3c-6ee97f0e7349 ==============================
[0m14:19:42.290724 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:19:42.291838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:42.320372 [info ] [MainThread]: dbt version: 1.9.4
[0m14:19:42.321373 [info ] [MainThread]: python version: 3.12.8
[0m14:19:42.321373 [info ] [MainThread]: python path: C:\Users\Amadan\AppData\Local\Programs\Python\Python312\python.exe
[0m14:19:42.321373 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:19:42.387819 [info ] [MainThread]: Using profiles dir at C:\Users\Amadan\.dbt
[0m14:19:42.388336 [info ] [MainThread]: Using profiles.yml file at C:\Users\Amadan\.dbt\profiles.yml
[0m14:19:42.388854 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\dbt_project.yml
[0m14:19:42.390448 [info ] [MainThread]: adapter type: postgres
[0m14:19:42.390967 [info ] [MainThread]: adapter version: 1.9.0
[0m14:19:42.459264 [info ] [MainThread]: Configuration:
[0m14:19:42.460400 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:19:42.460400 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:19:42.460911 [info ] [MainThread]: Required dependencies:
[0m14:19:42.460911 [debug] [MainThread]: Executing "git --help"
[0m14:19:42.603861 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:19:42.603861 [debug] [MainThread]: STDERR: "b''"
[0m14:19:42.604862 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:19:42.604862 [info ] [MainThread]: Connection:
[0m14:19:42.605862 [info ] [MainThread]:   host: localhost
[0m14:19:42.605862 [info ] [MainThread]:   port: 5432
[0m14:19:42.606861 [info ] [MainThread]:   user: postgres
[0m14:19:42.606861 [info ] [MainThread]:   database: dbt_postgres_etl
[0m14:19:42.606861 [info ] [MainThread]:   schema: public
[0m14:19:42.606861 [info ] [MainThread]:   connect_timeout: 10
[0m14:19:42.607861 [info ] [MainThread]:   role: None
[0m14:19:42.607861 [info ] [MainThread]:   search_path: None
[0m14:19:42.607861 [info ] [MainThread]:   keepalives_idle: 0
[0m14:19:42.607861 [info ] [MainThread]:   sslmode: None
[0m14:19:42.608861 [info ] [MainThread]:   sslcert: None
[0m14:19:42.608861 [info ] [MainThread]:   sslkey: None
[0m14:19:42.608861 [info ] [MainThread]:   sslrootcert: None
[0m14:19:42.609731 [info ] [MainThread]:   application_name: dbt
[0m14:19:42.609731 [info ] [MainThread]:   retries: 1
[0m14:19:42.610772 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:19:42.832602 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:19:43.040269 [debug] [MainThread]: Using postgres connection "debug"
[0m14:19:43.041268 [debug] [MainThread]: On debug: select 1 as id
[0m14:19:43.041268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:43.110350 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "dbt_postgres_etl" does not exist

[0m14:19:43.166201 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:19:43.167201 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:19:43.167201 [debug] [MainThread]: On debug: No close available on handle
[0m14:19:43.167201 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:19:43.168201 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:19:43.168201 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "dbt_postgres_etl" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:19:43.169200 [debug] [MainThread]: Command `dbt debug` failed at 14:19:43.169200 after 1.02 seconds
[0m14:19:43.169200 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:19:43.170200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CB74EDF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CB73966F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CB7394CE0>]}
[0m14:19:43.170200 [debug] [MainThread]: Flushing usage events
[0m14:19:43.703929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:41.489323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178995CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178C9CE9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178C9CFFE0>]}


============================== 14:20:41.492767 | acfb32ed-a9a1-4496-9490-f50d4b3adbd8 ==============================
[0m14:20:41.492767 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:20:41.492767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:41.510509 [info ] [MainThread]: dbt version: 1.9.4
[0m14:20:41.511507 [info ] [MainThread]: python version: 3.12.8
[0m14:20:41.511507 [info ] [MainThread]: python path: C:\Users\Amadan\AppData\Local\Programs\Python\Python312\python.exe
[0m14:20:41.512494 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:20:41.563122 [info ] [MainThread]: Using profiles dir at C:\Users\Amadan\.dbt
[0m14:20:41.564107 [info ] [MainThread]: Using profiles.yml file at C:\Users\Amadan\.dbt\profiles.yml
[0m14:20:41.564107 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\dbt_project.yml
[0m14:20:41.565123 [info ] [MainThread]: adapter type: postgres
[0m14:20:41.566137 [info ] [MainThread]: adapter version: 1.9.0
[0m14:20:41.632180 [info ] [MainThread]: Configuration:
[0m14:20:41.632769 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:20:41.633284 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:20:41.633333 [info ] [MainThread]: Required dependencies:
[0m14:20:41.633896 [debug] [MainThread]: Executing "git --help"
[0m14:20:41.722609 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:20:41.723610 [debug] [MainThread]: STDERR: "b''"
[0m14:20:41.723610 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:20:41.724610 [info ] [MainThread]: Connection:
[0m14:20:41.724610 [info ] [MainThread]:   host: localhost
[0m14:20:41.724610 [info ] [MainThread]:   port: 5432
[0m14:20:41.725629 [info ] [MainThread]:   user: postgres
[0m14:20:41.725629 [info ] [MainThread]:   database: dbt_postgres_etl
[0m14:20:41.725629 [info ] [MainThread]:   schema: public
[0m14:20:41.725629 [info ] [MainThread]:   connect_timeout: 10
[0m14:20:41.726625 [info ] [MainThread]:   role: None
[0m14:20:41.726625 [info ] [MainThread]:   search_path: None
[0m14:20:41.726625 [info ] [MainThread]:   keepalives_idle: 0
[0m14:20:41.727625 [info ] [MainThread]:   sslmode: None
[0m14:20:41.727625 [info ] [MainThread]:   sslcert: None
[0m14:20:41.727625 [info ] [MainThread]:   sslkey: None
[0m14:20:41.727625 [info ] [MainThread]:   sslrootcert: None
[0m14:20:41.728739 [info ] [MainThread]:   application_name: dbt
[0m14:20:41.728739 [info ] [MainThread]:   retries: 1
[0m14:20:41.729256 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:41.937306 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:20:42.089245 [debug] [MainThread]: Using postgres connection "debug"
[0m14:20:42.089245 [debug] [MainThread]: On debug: select 1 as id
[0m14:20:42.089245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:54.167477 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: timeout expired

[0m14:21:06.207793 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:21:06.208313 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:21:06.208313 [debug] [MainThread]: On debug: No close available on handle
[0m14:21:06.208313 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:21:06.209312 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:21:06.209312 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:21:06.210311 [debug] [MainThread]: Command `dbt debug` failed at 14:21:06.210311 after 24.86 seconds
[0m14:21:06.211313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:21:06.211313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178995CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178C9A28D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178C9A15B0>]}
[0m14:21:06.211313 [debug] [MainThread]: Flushing usage events
[0m14:21:06.748018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:47.700063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118A13415B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118A1342870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118A1342690>]}


============================== 14:23:47.703062 | f743d6bf-6c2a-4721-9f91-10447c2198cc ==============================
[0m14:23:47.703062 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:23:47.704068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:47.723063 [info ] [MainThread]: dbt version: 1.9.4
[0m14:23:47.724063 [info ] [MainThread]: python version: 3.12.8
[0m14:23:47.724063 [info ] [MainThread]: python path: C:\Users\Amadan\AppData\Local\Programs\Python\Python312\python.exe
[0m14:23:47.724063 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:23:47.779660 [info ] [MainThread]: Using profiles dir at C:\Users\Amadan\.dbt
[0m14:23:47.779660 [info ] [MainThread]: Using profiles.yml file at C:\Users\Amadan\.dbt\profiles.yml
[0m14:23:47.780660 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\dbt_project.yml
[0m14:23:47.781659 [info ] [MainThread]: adapter type: postgres
[0m14:23:47.782659 [info ] [MainThread]: adapter version: 1.9.0
[0m14:23:47.854220 [info ] [MainThread]: Configuration:
[0m14:23:47.854220 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:23:47.855218 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:23:47.856218 [info ] [MainThread]: Required dependencies:
[0m14:23:47.856218 [debug] [MainThread]: Executing "git --help"
[0m14:23:47.956817 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:23:47.957816 [debug] [MainThread]: STDERR: "b''"
[0m14:23:47.957816 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:23:47.957816 [info ] [MainThread]: Connection:
[0m14:23:47.958815 [info ] [MainThread]:   host: localhost
[0m14:23:47.958815 [info ] [MainThread]:   port: 5432
[0m14:23:47.958815 [info ] [MainThread]:   user: postgres
[0m14:23:47.959815 [info ] [MainThread]:   database: dbt_postgres_etl
[0m14:23:47.959815 [info ] [MainThread]:   schema: public
[0m14:23:47.959815 [info ] [MainThread]:   connect_timeout: 10
[0m14:23:47.959815 [info ] [MainThread]:   role: None
[0m14:23:47.960815 [info ] [MainThread]:   search_path: None
[0m14:23:47.960815 [info ] [MainThread]:   keepalives_idle: 0
[0m14:23:47.960815 [info ] [MainThread]:   sslmode: None
[0m14:23:47.961815 [info ] [MainThread]:   sslcert: None
[0m14:23:47.961815 [info ] [MainThread]:   sslkey: None
[0m14:23:47.961815 [info ] [MainThread]:   sslrootcert: None
[0m14:23:47.961815 [info ] [MainThread]:   application_name: dbt
[0m14:23:47.962815 [info ] [MainThread]:   retries: 1
[0m14:23:47.962815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:23:48.192157 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:23:48.368151 [debug] [MainThread]: Using postgres connection "debug"
[0m14:23:48.368670 [debug] [MainThread]: On debug: select 1 as id
[0m14:23:48.368670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:48.437334 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "dbt_postgres_etl" does not exist

[0m14:23:48.492168 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:23:48.492168 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:23:48.492168 [debug] [MainThread]: On debug: No close available on handle
[0m14:23:48.493168 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:23:48.493168 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:23:48.494168 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "dbt_postgres_etl" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:23:48.495167 [debug] [MainThread]: Command `dbt debug` failed at 14:23:48.495167 after 0.93 seconds
[0m14:23:48.496167 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:23:48.496167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118A0ED3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118A261F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118A05EF680>]}
[0m14:23:48.496167 [debug] [MainThread]: Flushing usage events
[0m14:23:49.111261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:34.291278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1D46F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1D8CC980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1D8CDF70>]}


============================== 14:24:34.294271 | 9efc8e96-ace2-456c-a98e-6cca451005d6 ==============================
[0m14:24:34.294271 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:24:34.295277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:34.312537 [info ] [MainThread]: dbt version: 1.9.4
[0m14:24:34.312582 [info ] [MainThread]: python version: 3.12.8
[0m14:24:34.313101 [info ] [MainThread]: python path: C:\Users\Amadan\AppData\Local\Programs\Python\Python312\python.exe
[0m14:24:34.313685 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:24:34.363898 [info ] [MainThread]: Using profiles dir at C:\Users\Amadan\.dbt
[0m14:24:34.364425 [info ] [MainThread]: Using profiles.yml file at C:\Users\Amadan\.dbt\profiles.yml
[0m14:24:34.364946 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\dbt_project.yml
[0m14:24:34.366022 [info ] [MainThread]: adapter type: postgres
[0m14:24:34.366541 [info ] [MainThread]: adapter version: 1.9.0
[0m14:24:34.435722 [info ] [MainThread]: Configuration:
[0m14:24:34.436273 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:24:34.436839 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:24:34.437400 [info ] [MainThread]: Required dependencies:
[0m14:24:34.437400 [debug] [MainThread]: Executing "git --help"
[0m14:24:34.542256 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:24:34.542834 [debug] [MainThread]: STDERR: "b''"
[0m14:24:34.542834 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:24:34.543424 [info ] [MainThread]: Connection:
[0m14:24:34.543990 [info ] [MainThread]:   host: localhost
[0m14:24:34.543990 [info ] [MainThread]:   port: 5432
[0m14:24:34.544553 [info ] [MainThread]:   user: postgres
[0m14:24:34.544553 [info ] [MainThread]:   database: dbt_postgres_etl
[0m14:24:34.545115 [info ] [MainThread]:   schema: public
[0m14:24:34.545115 [info ] [MainThread]:   connect_timeout: 10
[0m14:24:34.545721 [info ] [MainThread]:   role: None
[0m14:24:34.546248 [info ] [MainThread]:   search_path: None
[0m14:24:34.546248 [info ] [MainThread]:   keepalives_idle: 0
[0m14:24:34.546762 [info ] [MainThread]:   sslmode: None
[0m14:24:34.546762 [info ] [MainThread]:   sslcert: None
[0m14:24:34.546762 [info ] [MainThread]:   sslkey: None
[0m14:24:34.546762 [info ] [MainThread]:   sslrootcert: None
[0m14:24:34.547779 [info ] [MainThread]:   application_name: dbt
[0m14:24:34.547779 [info ] [MainThread]:   retries: 1
[0m14:24:34.547779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:34.765948 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:24:34.927816 [debug] [MainThread]: Using postgres connection "debug"
[0m14:24:34.927816 [debug] [MainThread]: On debug: select 1 as id
[0m14:24:34.927816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:34.988822 [debug] [MainThread]: SQL status: SELECT 1 in 0.061 seconds
[0m14:24:34.989822 [debug] [MainThread]: On debug: Close
[0m14:24:34.989822 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:24:34.989822 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:24:34.990806 [debug] [MainThread]: Command `dbt debug` succeeded at 14:24:34.990806 after 0.83 seconds
[0m14:24:34.991808 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:24:34.991808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1EB20080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1D91ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1D91DC10>]}
[0m14:24:34.991808 [debug] [MainThread]: Flushing usage events
[0m14:24:35.551098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:10.220170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A630CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A8F3D1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A91305F0>]}


============================== 14:55:10.223748 | 5dc34169-798b-4d20-9dc8-97eb6df9a76b ==============================
[0m14:55:10.223748 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:55:10.224733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:10.493682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc34169-798b-4d20-9dc8-97eb6df9a76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AA57A3C0>]}
[0m14:55:10.538772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc34169-798b-4d20-9dc8-97eb6df9a76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A925E720>]}
[0m14:55:10.539772 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:55:10.758297 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:55:10.759556 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:55:10.760510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dc34169-798b-4d20-9dc8-97eb6df9a76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AA680620>]}
[0m14:55:11.507860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dc34169-798b-4d20-9dc8-97eb6df9a76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AA935820>]}
[0m14:55:11.542512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m14:55:11.573806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m14:55:11.601693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dc34169-798b-4d20-9dc8-97eb6df9a76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AA65AB10>]}
[0m14:55:11.601693 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m14:55:11.602692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc34169-798b-4d20-9dc8-97eb6df9a76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AAB98710>]}
[0m14:55:11.603693 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:55:11.603693 [debug] [MainThread]: Command end result
[0m14:55:11.615860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m14:55:11.619012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m14:55:11.622061 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m14:55:11.622061 [info ] [MainThread]: 
[0m14:55:11.622061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:11.623060 [info ] [MainThread]: 
[0m14:55:11.623060 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m14:55:11.624085 [debug] [MainThread]: Command `dbt seed` succeeded at 14:55:11.624085 after 1.54 seconds
[0m14:55:11.624085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A916C800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A630CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A9105E20>]}
[0m14:55:11.625080 [debug] [MainThread]: Flushing usage events
[0m14:55:12.257600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:01.662414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217399D22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217399D22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217399D2840>]}


============================== 15:31:01.666488 | 416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0 ==============================
[0m15:31:01.666488 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:31:01.667051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:31:01.890938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173AB20110>]}
[0m15:31:01.937159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739A01460>]}
[0m15:31:01.938803 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:31:02.155242 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:31:02.281010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:02.281010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:02.301420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739A001A0>]}
[0m15:31:02.336989 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m15:31:02.352155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m15:31:02.379336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B0CABD0>]}
[0m15:31:02.379336 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m15:31:02.380337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739A4AD20>]}
[0m15:31:02.381356 [info ] [MainThread]: 
[0m15:31:02.381356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:02.382336 [info ] [MainThread]: 
[0m15:31:02.382336 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:02.384924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m15:31:02.586251 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m15:31:02.586251 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m15:31:02.586251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:02.650537 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.064 seconds
[0m15:31:02.651535 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m15:31:02.653110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m15:31:02.658100 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m15:31:02.658100 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m15:31:02.658612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:02.711993 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m15:31:02.711993 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m15:31:02.712970 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:31:02.716985 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m15:31:02.716985 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m15:31:02.718030 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m15:31:02.721027 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.721027 [debug] [MainThread]: On master: BEGIN
[0m15:31:02.721027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:02.774922 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m15:31:02.775435 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.775435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:02.780752 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:31:02.781788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173AB48230>]}
[0m15:31:02.781788 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:02.782803 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.782803 [debug] [MainThread]: On master: BEGIN
[0m15:31:02.782803 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:31:02.782803 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.783804 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.783804 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.783804 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:02.784803 [debug] [MainThread]: On master: Close
[0m15:31:02.799102 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m15:31:02.800101 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:31:02.800101 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.my_first_dbt_model'
[0m15:31:02.801102 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m15:31:02.805102 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.807103 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m15:31:02.828649 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.831630 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.831630 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m15:31:02.831630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:02.885745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m15:31:02.886257 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.886779 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:31:02.890708 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m15:31:02.897223 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.897276 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:31:02.898402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:02.906011 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m15:31:02.907009 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.907009 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m15:31:02.908009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:02.911025 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m15:31:02.914011 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m15:31:02.914011 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:31:02.914011 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:31:02.916007 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m15:31:02.917993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738CC4D70>]}
[0m15:31:02.917993 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m15:31:02.919088 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m15:31:02.919605 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m15:31:02.919605 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:31:02.919605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m15:31:02.920622 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m15:31:02.921619 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:02.923604 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m15:31:02.932619 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:02.934623 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:02.934623 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m15:31:02.935412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:02.991101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m15:31:02.991673 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:02.991673 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:31:02.995355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:31:02.998083 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:02.998613 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:31:02.999164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:03.000218 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m15:31:03.000746 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:03.000746 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m15:31:03.002896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:31:03.004478 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m15:31:03.006562 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m15:31:03.007091 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:31:03.007616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:31:03.008667 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m15:31:03.009194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416f9edc-e2dd-4cd9-9a5a-b5bcab024eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B512ED0>]}
[0m15:31:03.009839 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:31:03.010365 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m15:31:03.011947 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:03.011947 [debug] [MainThread]: On master: BEGIN
[0m15:31:03.012512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:03.069204 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m15:31:03.069204 [debug] [MainThread]: On master: COMMIT
[0m15:31:03.069204 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:03.069204 [debug] [MainThread]: On master: COMMIT
[0m15:31:03.070206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:03.070206 [debug] [MainThread]: On master: Close
[0m15:31:03.070206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:03.071205 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m15:31:03.071205 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m15:31:03.071205 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m15:31:03.071205 [info ] [MainThread]: 
[0m15:31:03.071205 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m15:31:03.072206 [debug] [MainThread]: Command end result
[0m15:31:03.084127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m15:31:03.087167 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m15:31:03.091444 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m15:31:03.091444 [info ] [MainThread]: 
[0m15:31:03.092444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:03.092444 [info ] [MainThread]: 
[0m15:31:03.092444 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:31:03.093444 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:03.093444 after 1.57 seconds
[0m15:31:03.094446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217398E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173AC2F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B01B7A0>]}
[0m15:31:03.094446 [debug] [MainThread]: Flushing usage events
[0m15:31:03.709996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:30.989736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4464442C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A446444290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A446444710>]}


============================== 09:48:30.993737 | 0247f2d8-0352-49e9-b76b-e7e67ca13768 ==============================
[0m09:48:30.993737 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:48:30.994736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:48:31.238834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A446583590>]}
[0m09:48:31.284594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4460C3110>]}
[0m09:48:31.285595 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:48:31.517469 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:48:31.646487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m09:48:31.647504 [debug] [MainThread]: Partial parsing: added file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m09:48:31.647504 [debug] [MainThread]: Partial parsing: added file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m09:48:31.647504 [debug] [MainThread]: Partial parsing: added file: postgres_dbt_analytics://models\shop_data\customers.sql
[0m09:48:31.832147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A447D571A0>]}
[0m09:48:31.871789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:48:31.893789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:48:31.920860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A447EBD460>]}
[0m09:48:31.921378 [info ] [MainThread]: Found 5 models, 4 data tests, 433 macros
[0m09:48:31.921899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A447CDC5F0>]}
[0m09:48:31.923454 [info ] [MainThread]: 
[0m09:48:31.923454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:48:31.923971 [info ] [MainThread]: 
[0m09:48:31.924486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:48:31.927129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m09:48:32.147651 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m09:48:32.147651 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m09:48:32.147651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:32.213109 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m09:48:32.214236 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m09:48:32.216461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m09:48:32.258720 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:48:32.259233 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m09:48:32.259233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:32.317033 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m09:48:32.317601 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:48:32.317601 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:48:32.322528 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:48:32.323615 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m09:48:32.324131 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m09:48:32.327852 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.327852 [debug] [MainThread]: On master: BEGIN
[0m09:48:32.328427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:32.385475 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m09:48:32.385475 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.386492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:48:32.391476 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m09:48:32.392500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A447DF9460>]}
[0m09:48:32.392500 [debug] [MainThread]: On master: ROLLBACK
[0m09:48:32.393490 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.393490 [debug] [MainThread]: On master: BEGIN
[0m09:48:32.394010 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:48:32.394010 [debug] [MainThread]: On master: COMMIT
[0m09:48:32.394617 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.394617 [debug] [MainThread]: On master: COMMIT
[0m09:48:32.395133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:48:32.395133 [debug] [MainThread]: On master: Close
[0m09:48:32.399130 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m09:48:32.399130 [info ] [Thread-1 (]: 1 of 5 START sql view model public.customer_orders ............................. [RUN]
[0m09:48:32.400137 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m09:48:32.400660 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m09:48:32.404531 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m09:48:32.407067 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m09:48:32.427296 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m09:48:32.429297 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:48:32.430297 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m09:48:32.430297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:48:32.490586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m09:48:32.491585 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:48:32.491585 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count 

count(case when  order_status='returned' then 1 else 0 end) as returned_count 

count(case when  order_status='completed' then 1 else 0 end) as completed_count 

count(case when  order_status='placed' then 1 else 0 end) as placed_count 

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count 
,
 count(*) as number_of_orders from dbt_postgres_etl.orders 
group by user_id
)
  );
[0m09:48:32.492590 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "count"
LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
         ^

[0m09:48:32.492590 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m09:48:32.492590 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m09:48:32.502586 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:48:32.504586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A445824A10>]}
[0m09:48:32.504586 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.10s]
[0m09:48:32.505586 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m09:48:32.505586 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customers
[0m09:48:32.506586 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m09:48:32.506586 [info ] [Thread-1 (]: 2 of 5 START sql view model public.customers ................................... [RUN]
[0m09:48:32.507586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.customers)
[0m09:48:32.507586 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customers
[0m09:48:32.508586 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customers"
[0m09:48:32.510585 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customers
[0m09:48:32.512586 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customers"
[0m09:48:32.514585 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customers"
[0m09:48:32.514585 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customers: BEGIN
[0m09:48:32.514585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:32.572595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m09:48:32.572595 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customers"
[0m09:48:32.572595 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customers"} */

  create view "dbt_postgres_etl"."public"."customers__dbt_tmp"
    
    
  as (
    select * from dbt_postgres_etl.customers;
  );
[0m09:48:32.573595 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 7:     select * from dbt_postgres_etl.customers;
                                                    ^

[0m09:48:32.573595 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customers: ROLLBACK
[0m09:48:32.573595 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customers: Close
[0m09:48:32.575595 [debug] [Thread-1 (]: Database Error in model customers (models\shop_data\customers.sql)
  syntax error at or near ";"
  LINE 7:     select * from dbt_postgres_etl.customers;
                                                      ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customers.sql
[0m09:48:32.576594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4477C6090>]}
[0m09:48:32.576594 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.07s]
[0m09:48:32.577595 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customers
[0m09:48:32.577595 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:48:32.578594 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (models\shop_data\customers.sql)
  syntax error at or near ";"
  LINE 7:     select * from dbt_postgres_etl.customers;
                                                      ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customers.sql.
[0m09:48:32.578594 [info ] [Thread-1 (]: 3 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m09:48:32.578594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customers, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m09:48:32.579595 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:48:32.580595 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.582594 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:48:32.594594 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.596595 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.596595 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m09:48:32.597596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:32.659680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m09:48:32.660679 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.660679 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:48:32.667176 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m09:48:32.679379 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.679903 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:48:32.681026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:48:32.683121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.683121 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:48:32.684174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:48:32.694249 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:48:32.694776 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.695296 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:48:32.696397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:48:32.699972 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m09:48:32.703104 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:48:32.703630 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m09:48:32.721954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m09:48:32.723954 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m09:48:32.724954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4435FB290>]}
[0m09:48:32.724954 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.15s]
[0m09:48:32.725954 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:48:32.725954 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m09:48:32.725954 [info ] [Thread-1 (]: 4 of 5 START sql view model public.order_payments .............................. [RUN]
[0m09:48:32.726956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m09:48:32.726956 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m09:48:32.729445 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m09:48:32.730958 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m09:48:32.732957 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m09:48:32.735184 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:48:32.735184 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m09:48:32.735712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:32.795352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m09:48:32.795876 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:48:32.795876 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as 'credit_card'_amount 

sum(case when payment_method='bank_transfer' then amount  end ) as 'bank_transfer'_amount 

sum(case when payment_method='coupon' then amount  end ) as 'coupon'_amount 

sum(case when payment_method='gift_card' then amount  end ) as 'gift_card'_amount 

sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id
;
) 
select * from order_payment_amount
  );
[0m09:48:32.796398 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "'credit_card'"
LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                              ^

[0m09:48:32.796922 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m09:48:32.797443 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m09:48:32.799523 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "'credit_card'"
  LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:48:32.800044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4465CC170>]}
[0m09:48:32.800646 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m09:48:32.801171 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m09:48:32.801171 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:48:32.801692 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "'credit_card'"
  LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m09:48:32.802219 [info ] [Thread-1 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m09:48:32.802741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m09:48:32.802741 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:48:32.804252 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.806252 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:48:32.808253 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.810040 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.810055 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m09:48:32.810055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:32.869134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m09:48:32.869655 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.870174 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m09:48:32.873209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:48:32.875208 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.875208 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:48:32.876362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:48:32.877437 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:48:32.877476 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.877476 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:48:32.878526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:48:32.880518 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m09:48:32.882496 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:48:32.882496 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m09:48:32.883496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:48:32.884495 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m09:48:32.884495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0247f2d8-0352-49e9-b76b-e7e67ca13768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44533AD50>]}
[0m09:48:32.885495 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:48:32.885495 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:48:32.886496 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.887496 [debug] [MainThread]: On master: BEGIN
[0m09:48:32.887496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:32.948521 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m09:48:32.948521 [debug] [MainThread]: On master: COMMIT
[0m09:48:32.949055 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:32.949055 [debug] [MainThread]: On master: COMMIT
[0m09:48:32.949581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:48:32.950093 [debug] [MainThread]: On master: Close
[0m09:48:32.950112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:32.950642 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m09:48:32.950642 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m09:48:32.950642 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m09:48:32.951163 [info ] [MainThread]: 
[0m09:48:32.951690 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m09:48:32.952733 [debug] [MainThread]: Command end result
[0m09:48:32.965494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:48:32.968836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:48:32.974319 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m09:48:32.974319 [info ] [MainThread]: 
[0m09:48:32.974848 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:48:32.975370 [info ] [MainThread]: 
[0m09:48:32.975892 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:48:32.976414 [info ] [MainThread]: 
[0m09:48:32.976937 [error] [MainThread]:   Database Error in model customers (models\shop_data\customers.sql)
  syntax error at or near ";"
  LINE 7:     select * from dbt_postgres_etl.customers;
                                                      ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customers.sql
[0m09:48:32.977461 [info ] [MainThread]: 
[0m09:48:32.977461 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "'credit_card'"
  LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:48:32.977981 [info ] [MainThread]: 
[0m09:48:32.978502 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m09:48:32.979547 [debug] [MainThread]: Command `dbt run` failed at 09:48:32.979547 after 2.12 seconds
[0m09:48:32.980063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A446286D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A447DF95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44641F050>]}
[0m09:48:32.980128 [debug] [MainThread]: Flushing usage events
[0m09:48:33.687267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:53.459356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE47B8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE1F55EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE1F56DB0>]}


============================== 09:50:53.463357 | f3a14b0a-e6c9-4db9-bfca-d27e293ddec5 ==============================
[0m09:50:53.463357 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:50:53.463357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:53.658816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE5110710>]}
[0m09:50:53.702414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE45AA420>]}
[0m09:50:53.704414 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:50:53.916926 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:50:54.040349 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m09:50:54.040484 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt_analytics://models\shop_data\customers.sql
[0m09:50:54.040996 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m09:50:54.212867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE62CD2E0>]}
[0m09:50:54.246490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:50:54.260582 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:50:54.282649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE69E4CE0>]}
[0m09:50:54.283649 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m09:50:54.283649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE664A660>]}
[0m09:50:54.285649 [info ] [MainThread]: 
[0m09:50:54.285649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:54.285649 [info ] [MainThread]: 
[0m09:50:54.286649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:50:54.290649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m09:50:54.451777 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m09:50:54.451777 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m09:50:54.452777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:54.516741 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.064 seconds
[0m09:50:54.517724 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m09:50:54.518722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m09:50:54.523723 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:50:54.523723 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m09:50:54.523723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:54.578823 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m09:50:54.579822 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:50:54.579822 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:50:54.583823 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:50:54.584851 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m09:50:54.584851 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m09:50:54.622093 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:54.622093 [debug] [MainThread]: On master: BEGIN
[0m09:50:54.622093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:54.678377 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m09:50:54.678377 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:54.678377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:50:54.683060 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m09:50:54.684060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE46CCB30>]}
[0m09:50:54.685061 [debug] [MainThread]: On master: ROLLBACK
[0m09:50:54.685061 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:54.685061 [debug] [MainThread]: On master: BEGIN
[0m09:50:54.686060 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:50:54.686060 [debug] [MainThread]: On master: COMMIT
[0m09:50:54.686060 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:54.686060 [debug] [MainThread]: On master: COMMIT
[0m09:50:54.687083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:54.687083 [debug] [MainThread]: On master: Close
[0m09:50:54.691060 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m09:50:54.691060 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m09:50:54.692099 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m09:50:54.692099 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m09:50:54.696727 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m09:50:54.698261 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m09:50:54.717003 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m09:50:54.718014 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:50:54.719009 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m09:50:54.719009 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:50:54.775662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m09:50:54.775662 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:50:54.775662 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count 

count(case when  order_status='returned' then 1 else 0 end) as returned_count 

count(case when  order_status='completed' then 1 else 0 end) as completed_count 

count(case when  order_status='placed' then 1 else 0 end) as placed_count 

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count 
,
 count(*) as number_of_orders from dbt_postgres_etl.orders 
 from orders
group by user_id
)
  );
[0m09:50:54.776662 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "count"
LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
         ^

[0m09:50:54.776662 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m09:50:54.777661 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m09:50:54.783663 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:50:54.784662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE6C92210>]}
[0m09:50:54.785663 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m09:50:54.786661 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m09:50:54.786661 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:50:54.786661 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m09:50:54.787689 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m09:50:54.788201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m09:50:54.788201 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:50:54.790198 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.792200 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:50:54.804200 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.805200 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.806199 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m09:50:54.806199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:54.861319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m09:50:54.861319 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.861319 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:50:54.865324 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:50:54.871319 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.871319 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:50:54.872319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:50:54.874318 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.874318 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:50:54.875319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:50:54.884467 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:50:54.884467 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.884467 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:50:54.885467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:50:54.890466 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m09:50:54.893479 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:50:54.893479 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m09:50:54.910467 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m09:50:54.912483 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m09:50:54.912556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE6CFF440>]}
[0m09:50:54.913069 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m09:50:54.914068 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:50:54.914068 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m09:50:54.914068 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m09:50:54.915069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m09:50:54.915069 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m09:50:54.917069 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m09:50:54.918068 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m09:50:54.920068 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m09:50:54.922069 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:50:54.922069 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m09:50:54.922069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:54.978780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m09:50:54.978780 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:50:54.979801 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as 'credit_card'_amount 

sum(case when payment_method='bank_transfer' then amount  end ) as 'bank_transfer'_amount 

sum(case when payment_method='coupon' then amount  end ) as 'coupon'_amount 

sum(case when payment_method='gift_card' then amount  end ) as 'gift_card'_amount 

sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id
;
) 
select * from order_payment_amount
  );
[0m09:50:54.979801 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "'credit_card'"
LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                              ^

[0m09:50:54.980781 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m09:50:54.980781 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m09:50:54.982824 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "'credit_card'"
  LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:50:54.983332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE6726960>]}
[0m09:50:54.983848 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m09:50:54.984369 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m09:50:54.984889 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:50:54.985408 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "'credit_card'"
  LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m09:50:54.985408 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m09:50:54.985926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m09:50:54.986439 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:50:54.987471 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:54.989470 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:50:54.991471 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:54.992470 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:54.992470 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m09:50:54.993470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:55.047016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m09:50:55.048016 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:55.048016 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m09:50:55.051018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:50:55.053017 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:55.053017 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:50:55.054017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:50:55.055018 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:50:55.055018 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:55.056018 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:50:55.058018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:50:55.059016 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m09:50:55.061031 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:50:55.061031 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m09:50:55.062017 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:50:55.062017 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m09:50:55.063035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a14b0a-e6c9-4db9-bfca-d27e293ddec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE6DBB110>]}
[0m09:50:55.063035 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:50:55.064018 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:50:55.065017 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.065017 [debug] [MainThread]: On master: BEGIN
[0m09:50:55.065017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:55.118616 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m09:50:55.118616 [debug] [MainThread]: On master: COMMIT
[0m09:50:55.118616 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.119639 [debug] [MainThread]: On master: COMMIT
[0m09:50:55.119639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:55.119639 [debug] [MainThread]: On master: Close
[0m09:50:55.120614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:55.120614 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m09:50:55.120614 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m09:50:55.120614 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m09:50:55.120614 [info ] [MainThread]: 
[0m09:50:55.121614 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m09:50:55.122614 [debug] [MainThread]: Command end result
[0m09:50:55.134278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:50:55.137277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:50:55.141283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m09:50:55.142262 [info ] [MainThread]: 
[0m09:50:55.142262 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:50:55.143261 [info ] [MainThread]: 
[0m09:50:55.143261 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:50:55.143261 [info ] [MainThread]: 
[0m09:50:55.144261 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "'credit_card'"
  LINE 13: ...ayment_method='credit_card' then amount  end ) as 'credit_ca...
                                                                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:50:55.144261 [info ] [MainThread]: 
[0m09:50:55.145261 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m09:50:55.145261 [debug] [MainThread]: Command `dbt run` failed at 09:50:55.145261 after 1.81 seconds
[0m09:50:55.146261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE4BEEC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE63EEF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE221A330>]}
[0m09:50:55.146261 [debug] [MainThread]: Flushing usage events
[0m09:50:55.723256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:29.576579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D49360F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D49370B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D4936F60>]}


============================== 09:52:29.580580 | d515b9c8-96aa-4e52-98ee-69dff713d1e3 ==============================
[0m09:52:29.580580 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:52:29.580580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:52:29.778208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D49A9370>]}
[0m09:52:29.821339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D3F737D0>]}
[0m09:52:29.822486 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:30.033993 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:52:30.151834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:30.151834 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m09:52:30.332213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D5E5EF90>]}
[0m09:52:30.365941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:52:30.378934 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:52:30.401639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D61D49E0>]}
[0m09:52:30.401639 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m09:52:30.402285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D60E7A40>]}
[0m09:52:30.403546 [info ] [MainThread]: 
[0m09:52:30.404203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:30.404203 [info ] [MainThread]: 
[0m09:52:30.404833 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:30.407551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m09:52:30.563535 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m09:52:30.564602 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m09:52:30.564602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:30.630139 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m09:52:30.631422 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m09:52:30.632422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m09:52:30.638557 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:52:30.639085 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m09:52:30.639085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:30.692137 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m09:52:30.692653 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:52:30.692653 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:52:30.696751 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:52:30.697780 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m09:52:30.697780 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m09:52:30.735504 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.735504 [debug] [MainThread]: On master: BEGIN
[0m09:52:30.735504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:30.898879 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m09:52:30.898879 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.899991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:30.903988 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:52:30.904880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D607BC20>]}
[0m09:52:30.905880 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:30.905880 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.905880 [debug] [MainThread]: On master: BEGIN
[0m09:52:30.906945 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:52:30.906945 [debug] [MainThread]: On master: COMMIT
[0m09:52:30.906945 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.906945 [debug] [MainThread]: On master: COMMIT
[0m09:52:30.907942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:30.907942 [debug] [MainThread]: On master: Close
[0m09:52:30.911942 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m09:52:30.911942 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m09:52:30.912943 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m09:52:30.912943 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m09:52:30.916942 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m09:52:30.918942 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m09:52:30.937941 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m09:52:30.939940 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:52:30.939940 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m09:52:30.939940 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:52:30.993593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:52:30.994597 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:52:30.994597 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count 

count(case when  order_status='returned' then 1 else 0 end) as returned_count 

count(case when  order_status='completed' then 1 else 0 end) as completed_count 

count(case when  order_status='placed' then 1 else 0 end) as placed_count 

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count 
,
 count(*) as number_of_orders from dbt_postgres_etl.orders 
 from orders
group by user_id
)
  );
[0m09:52:30.994597 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "count"
LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
         ^

[0m09:52:30.995580 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m09:52:30.995580 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m09:52:31.001634 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:52:31.003171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D5F1DB80>]}
[0m09:52:31.003171 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m09:52:31.004147 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m09:52:31.004147 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:52:31.005146 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m09:52:31.005146 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m09:52:31.006146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m09:52:31.006146 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:52:31.008145 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.009145 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:52:31.020145 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.022145 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.022145 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m09:52:31.023145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:31.074729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m09:52:31.075757 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.075757 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:52:31.079729 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:52:31.085330 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.085330 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:52:31.086318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:52:31.087317 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.087317 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:52:31.088317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:31.098499 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:52:31.098499 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.098499 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:52:31.099501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:31.104500 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m09:52:31.106485 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:52:31.107485 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m09:52:31.123646 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m09:52:31.125659 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m09:52:31.125659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D19FB200>]}
[0m09:52:31.126646 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m09:52:31.127646 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:52:31.127646 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m09:52:31.127646 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m09:52:31.128646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m09:52:31.128646 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m09:52:31.130646 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m09:52:31.131647 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m09:52:31.133661 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m09:52:31.134647 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:52:31.135647 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m09:52:31.135647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:31.188825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:52:31.188825 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:52:31.188825 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount 

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount 

sum(case when payment_method='coupon' then amount  end ) as coupon_amount 

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount 

sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id
;
) 
select * from order_payment_amount
  );
[0m09:52:31.189842 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "sum"
LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
         ^

[0m09:52:31.189842 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m09:52:31.190855 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m09:52:31.192825 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:52:31.192825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D648B2C0>]}
[0m09:52:31.192825 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.06s]
[0m09:52:31.193825 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m09:52:31.193825 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:52:31.194825 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m09:52:31.194825 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m09:52:31.195824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m09:52:31.195824 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:52:31.197824 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.198824 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:52:31.200824 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.201826 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.202823 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m09:52:31.202823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:31.258428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m09:52:31.258428 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.258428 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m09:52:31.261430 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:52:31.263442 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.263442 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:52:31.264442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:52:31.265448 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:52:31.265448 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.265448 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:52:31.267072 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:31.269069 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m09:52:31.271068 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:52:31.271068 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m09:52:31.271068 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:52:31.272068 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m09:52:31.272068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd515b9c8-96aa-4e52-98ee-69dff713d1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D65BFDA0>]}
[0m09:52:31.273069 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:52:31.274069 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:52:31.274069 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:31.275069 [debug] [MainThread]: On master: BEGIN
[0m09:52:31.275069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:31.329198 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m09:52:31.329198 [debug] [MainThread]: On master: COMMIT
[0m09:52:31.330225 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:31.330225 [debug] [MainThread]: On master: COMMIT
[0m09:52:31.330225 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:31.330225 [debug] [MainThread]: On master: Close
[0m09:52:31.331198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:31.331198 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m09:52:31.331198 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m09:52:31.331198 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m09:52:31.331198 [info ] [MainThread]: 
[0m09:52:31.332198 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m09:52:31.333197 [debug] [MainThread]: Command end result
[0m09:52:31.344209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:52:31.347196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:52:31.351196 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m09:52:31.351196 [info ] [MainThread]: 
[0m09:52:31.352196 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:52:31.352196 [info ] [MainThread]: 
[0m09:52:31.352196 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:52:31.353197 [info ] [MainThread]: 
[0m09:52:31.353197 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:52:31.354197 [info ] [MainThread]: 
[0m09:52:31.354197 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m09:52:31.355196 [debug] [MainThread]: Command `dbt run` failed at 09:52:31.355196 after 1.90 seconds
[0m09:52:31.355196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D5FA0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D607AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D6022390>]}
[0m09:52:31.356197 [debug] [MainThread]: Flushing usage events
[0m09:52:32.026702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:25.928445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143750922A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014375092150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014375092480>]}


============================== 09:55:25.932464 | fc1adabf-a09b-4043-81cc-f1abbd865928 ==============================
[0m09:55:25.932464 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:55:25.933445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:55:26.136709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001437510B230>]}
[0m09:55:26.179954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143750E3A40>]}
[0m09:55:26.180956 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:26.403009 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:55:26.521775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:26.522771 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m09:55:26.698067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014374C5DB20>]}
[0m09:55:26.730872 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:55:26.744558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:55:26.767001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143769650A0>]}
[0m09:55:26.767001 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m09:55:26.768024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001437687BEF0>]}
[0m09:55:26.769076 [info ] [MainThread]: 
[0m09:55:26.769076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:26.769076 [info ] [MainThread]: 
[0m09:55:26.770070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:26.772541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m09:55:26.931878 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m09:55:26.931878 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m09:55:26.931878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:26.996790 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.064 seconds
[0m09:55:26.997776 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m09:55:26.998777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m09:55:27.004453 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:55:27.004453 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m09:55:27.004966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:27.057226 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m09:55:27.058237 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:55:27.058237 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:55:27.062041 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:55:27.063040 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m09:55:27.063040 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m09:55:27.100719 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:27.100957 [debug] [MainThread]: On master: BEGIN
[0m09:55:27.100957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:27.157986 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m09:55:27.157986 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:27.157986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:27.162988 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:55:27.163984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143768BBE00>]}
[0m09:55:27.163984 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:27.164979 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:27.164979 [debug] [MainThread]: On master: BEGIN
[0m09:55:27.164979 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:55:27.164979 [debug] [MainThread]: On master: COMMIT
[0m09:55:27.165976 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:27.165976 [debug] [MainThread]: On master: COMMIT
[0m09:55:27.165976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:27.165976 [debug] [MainThread]: On master: Close
[0m09:55:27.169807 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m09:55:27.170832 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m09:55:27.170832 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m09:55:27.170832 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m09:55:27.175858 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m09:55:27.176951 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m09:55:27.195742 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m09:55:27.197719 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:55:27.197719 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m09:55:27.198720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:27.373432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.175 seconds
[0m09:55:27.373432 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:55:27.373432 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count 

count(case when  order_status='returned' then 1 else 0 end) as returned_count 

count(case when  order_status='completed' then 1 else 0 end) as completed_count 

count(case when  order_status='placed' then 1 else 0 end) as placed_count 

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count 
,
 count(*) as number_of_orders from dbt_postgres_etl.orders 
 from orders
group by user_id
)
  );
[0m09:55:27.374449 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "count"
LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
         ^

[0m09:55:27.374449 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m09:55:27.375450 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m09:55:27.380432 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:55:27.382447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001437687B0E0>]}
[0m09:55:27.382447 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.21s]
[0m09:55:27.383431 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m09:55:27.383431 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:55:27.384446 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m09:55:27.383431 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m09:55:27.385379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m09:55:27.385379 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:55:27.387135 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.388267 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:55:27.398870 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.400873 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.400873 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m09:55:27.400873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:27.455350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m09:55:27.455945 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.455945 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:55:27.459871 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:55:27.465126 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.465126 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:55:27.466126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:55:27.468112 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.468112 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:55:27.469111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:27.477125 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:55:27.478125 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.478125 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:55:27.479124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:55:27.482904 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m09:55:27.485903 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:55:27.486961 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m09:55:27.504899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m09:55:27.505899 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m09:55:27.506900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014376C7C3B0>]}
[0m09:55:27.506900 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m09:55:27.507899 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:55:27.507899 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m09:55:27.507899 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m09:55:27.508899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m09:55:27.508899 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m09:55:27.510899 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m09:55:27.511899 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m09:55:27.514303 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m09:55:27.516292 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:55:27.516292 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m09:55:27.516292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:27.573440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m09:55:27.574004 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:55:27.574004 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount 

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount 

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount 

sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id
;
) 
select * from order_payment_amount
  );
[0m09:55:27.574540 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "sum"
LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
         ^

[0m09:55:27.575054 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m09:55:27.575578 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m09:55:27.577679 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:55:27.578202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143762F7260>]}
[0m09:55:27.578730 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m09:55:27.579258 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m09:55:27.579258 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:55:27.579774 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m09:55:27.579774 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m09:55:27.580795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m09:55:27.580795 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:55:27.582791 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.583790 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:55:27.585788 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.588256 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.588256 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m09:55:27.588795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:27.642676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m09:55:27.642676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.642676 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m09:55:27.645676 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:55:27.647675 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.647675 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:55:27.647675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:55:27.648676 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:55:27.648676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.649676 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:55:27.651675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:55:27.652676 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m09:55:27.654675 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:55:27.654675 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m09:55:27.655675 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:55:27.656675 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m09:55:27.656675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1adabf-a09b-4043-81cc-f1abbd865928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014376C2CBF0>]}
[0m09:55:27.657675 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:55:27.657675 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:55:27.658675 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:27.658675 [debug] [MainThread]: On master: BEGIN
[0m09:55:27.659674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:27.713066 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m09:55:27.713996 [debug] [MainThread]: On master: COMMIT
[0m09:55:27.713996 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:27.713996 [debug] [MainThread]: On master: COMMIT
[0m09:55:27.714996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:27.714996 [debug] [MainThread]: On master: Close
[0m09:55:27.714996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:27.714996 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m09:55:27.714996 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m09:55:27.715995 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m09:55:27.715995 [info ] [MainThread]: 
[0m09:55:27.715995 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m09:55:27.716997 [debug] [MainThread]: Command end result
[0m09:55:27.729028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:55:27.732015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:55:27.737022 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m09:55:27.737022 [info ] [MainThread]: 
[0m09:55:27.737022 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:55:27.738011 [info ] [MainThread]: 
[0m09:55:27.738011 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:55:27.739011 [info ] [MainThread]: 
[0m09:55:27.739011 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:55:27.739011 [info ] [MainThread]: 
[0m09:55:27.740010 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m09:55:27.741012 [debug] [MainThread]: Command `dbt run` failed at 09:55:27.741012 after 1.94 seconds
[0m09:55:27.741012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001437392B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143768BA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014373E1D220>]}
[0m09:55:27.741012 [debug] [MainThread]: Flushing usage events
[0m09:55:28.463988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:57.619600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016244C5F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016244FA4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016244FA4BC0>]}


============================== 09:57:57.623109 | ebfa214a-a6de-4bb9-b47e-276bc60d467d ==============================
[0m09:57:57.623109 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:57:57.623723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:57:57.830070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624624A3C0>]}
[0m09:57:57.873447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016244A8F290>]}
[0m09:57:57.874621 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:58.089466 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:57:58.208673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:57:58.209672 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m09:57:58.209672 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m09:57:58.385365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624677CCB0>]}
[0m09:57:58.418418 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:57:58.433096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:57:58.456267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016246959040>]}
[0m09:57:58.457258 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m09:57:58.457258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016246720B90>]}
[0m09:57:58.459422 [info ] [MainThread]: 
[0m09:57:58.459476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:58.459999 [info ] [MainThread]: 
[0m09:57:58.460513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:58.463116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m09:57:58.631866 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m09:57:58.632423 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m09:57:58.632423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:58.697419 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m09:57:58.698419 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m09:57:58.699403 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m09:57:58.737939 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:57:58.738939 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m09:57:58.738939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:58.794623 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m09:57:58.795150 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:57:58.795150 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:58.799519 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:57:58.800578 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m09:57:58.801101 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m09:57:58.804291 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:58.804800 [debug] [MainThread]: On master: BEGIN
[0m09:57:58.804882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:58.858791 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m09:57:58.858791 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:58.858791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:58.864472 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m09:57:58.865472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162467A2090>]}
[0m09:57:58.865472 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:58.866488 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:58.866488 [debug] [MainThread]: On master: BEGIN
[0m09:57:58.867051 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:57:58.867051 [debug] [MainThread]: On master: COMMIT
[0m09:57:58.867051 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:58.867051 [debug] [MainThread]: On master: COMMIT
[0m09:57:58.868063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:57:58.868063 [debug] [MainThread]: On master: Close
[0m09:57:58.871047 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m09:57:58.872065 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m09:57:58.872065 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m09:57:58.873063 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m09:57:58.876685 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m09:57:58.878734 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m09:57:58.897809 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m09:57:58.899012 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:57:58.899584 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m09:57:58.899584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:57:58.954127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m09:57:58.954127 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:57:58.954127 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count 

count(case when  order_status='returned' then 1 else 0 end) as returned_count 

count(case when  order_status='completed' then 1 else 0 end) as completed_count 

count(case when  order_status='placed' then 1 else 0 end) as placed_count 

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count 
,
 count(*) as number_of_orders from dbt_postgres_etl.orders 
 from orders
group by user_id
)
select * from customer_orders;
  );
[0m09:57:58.955143 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "count"
LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
         ^

[0m09:57:58.955143 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m09:57:58.956143 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m09:57:58.961126 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:57:58.963128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016244384350>]}
[0m09:57:58.964151 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m09:57:58.964151 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m09:57:58.964151 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:57:58.965145 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m09:57:58.965145 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m09:57:58.966143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m09:57:58.966143 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:57:58.968226 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:58.969762 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:57:58.980755 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:58.981882 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:58.982454 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m09:57:58.982454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:59.037869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m09:57:59.038423 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:59.038423 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:57:59.043430 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m09:57:59.049431 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:59.049431 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:57:59.049431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:57:59.051431 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:59.051431 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:57:59.052430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:57:59.062036 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:57:59.063170 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:59.063170 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:57:59.063733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:57:59.067736 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m09:57:59.070990 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:57:59.071517 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m09:57:59.091862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m09:57:59.093564 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m09:57:59.093564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162461E0890>]}
[0m09:57:59.094571 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.13s]
[0m09:57:59.094571 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:57:59.095556 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m09:57:59.095556 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m09:57:59.095556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m09:57:59.096723 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m09:57:59.098274 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m09:57:59.099930 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m09:57:59.102143 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m09:57:59.103310 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:57:59.103876 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m09:57:59.103876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:59.160047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m09:57:59.161047 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:57:59.161047 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount 

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount 

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount 
,
sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id
;
) 
select * from order_payment_amount
  );
[0m09:57:59.162050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "sum"
LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
         ^

[0m09:57:59.162050 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m09:57:59.162671 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m09:57:59.164815 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:57:59.164815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016246D33110>]}
[0m09:57:59.164815 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m09:57:59.165815 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m09:57:59.165815 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:57:59.166842 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m09:57:59.167133 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m09:57:59.167704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m09:57:59.167704 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:57:59.169262 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.171284 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:57:59.173332 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.174461 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.174461 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m09:57:59.174461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:59.231971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m09:57:59.232502 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.233023 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m09:57:59.236390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:57:59.238132 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.238683 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:57:59.238718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:57:59.239884 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:57:59.240477 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.240477 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:57:59.241616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:57:59.243328 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m09:57:59.245101 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:57:59.245619 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m09:57:59.246341 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:57:59.247424 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m09:57:59.247424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebfa214a-a6de-4bb9-b47e-276bc60d467d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016246357DA0>]}
[0m09:57:59.248440 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:57:59.248797 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:57:59.250366 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:59.250366 [debug] [MainThread]: On master: BEGIN
[0m09:57:59.250889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:59.307399 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m09:57:59.307399 [debug] [MainThread]: On master: COMMIT
[0m09:57:59.307969 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:59.307969 [debug] [MainThread]: On master: COMMIT
[0m09:57:59.308534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:57:59.308534 [debug] [MainThread]: On master: Close
[0m09:57:59.309098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:59.309098 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m09:57:59.309098 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m09:57:59.309662 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m09:57:59.309662 [info ] [MainThread]: 
[0m09:57:59.310183 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m09:57:59.311232 [debug] [MainThread]: Command end result
[0m09:57:59.323420 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:57:59.326708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:57:59.332065 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m09:57:59.332591 [info ] [MainThread]: 
[0m09:57:59.333112 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:57:59.333643 [info ] [MainThread]: 
[0m09:57:59.334173 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:57:59.334694 [info ] [MainThread]: 
[0m09:57:59.334694 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:57:59.335216 [info ] [MainThread]: 
[0m09:57:59.335751 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m09:57:59.336842 [debug] [MainThread]: Command `dbt run` failed at 09:57:59.336319 after 1.85 seconds
[0m09:57:59.336842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624432E900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016244B59790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162422E1DF0>]}
[0m09:57:59.337410 [debug] [MainThread]: Flushing usage events
[0m09:57:59.950343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:18.196302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF26459A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF68D5A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF68D64E0>]}


============================== 09:59:18.200302 | d401e41f-074e-49aa-be94-78b2f7e46792 ==============================
[0m09:59:18.200302 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:59:18.200302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:59:18.416263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF7CCD340>]}
[0m09:59:18.463765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF655D880>]}
[0m09:59:18.465765 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:59:18.680386 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:59:18.801699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:59:18.801699 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m09:59:18.802701 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m09:59:18.980173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF82B4DA0>]}
[0m09:59:19.015172 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:59:19.029172 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:59:19.051029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF83E8EC0>]}
[0m09:59:19.052029 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m09:59:19.052029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF8307CB0>]}
[0m09:59:19.053029 [info ] [MainThread]: 
[0m09:59:19.054028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:19.054028 [info ] [MainThread]: 
[0m09:59:19.054028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:19.057029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m09:59:19.218984 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m09:59:19.218984 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m09:59:19.219985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:19.284768 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m09:59:19.285768 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m09:59:19.287770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m09:59:19.327769 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:59:19.327769 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m09:59:19.327769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:19.386516 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m09:59:19.386516 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m09:59:19.387030 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:59:19.391029 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:59:19.392029 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m09:59:19.393029 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m09:59:19.396406 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:19.396962 [debug] [MainThread]: On master: BEGIN
[0m09:59:19.396962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:19.550620 [debug] [MainThread]: SQL status: BEGIN in 0.154 seconds
[0m09:59:19.551620 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:19.551620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:19.556631 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:59:19.557621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF8727470>]}
[0m09:59:19.557621 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:19.557621 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:19.558619 [debug] [MainThread]: On master: BEGIN
[0m09:59:19.558619 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:59:19.558619 [debug] [MainThread]: On master: COMMIT
[0m09:59:19.558619 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:19.559620 [debug] [MainThread]: On master: COMMIT
[0m09:59:19.559620 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:59:19.559620 [debug] [MainThread]: On master: Close
[0m09:59:19.563619 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m09:59:19.564620 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m09:59:19.565620 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m09:59:19.565620 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m09:59:19.569619 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m09:59:19.571619 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m09:59:19.589816 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m09:59:19.591816 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:59:19.592816 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m09:59:19.592816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:59:19.646395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:59:19.646395 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m09:59:19.646395 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count 

count(case when  order_status='returned' then 1 else 0 end) as returned_count 

count(case when  order_status='completed' then 1 else 0 end) as completed_count 

count(case when  order_status='placed' then 1 else 0 end) as placed_count 

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count 
,
 count(*) as number_of_orders from dbt_postgres_etl.orders 
 
group by user_id
)
select * from customer_orders;
  );
[0m09:59:19.647395 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "count"
LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
         ^

[0m09:59:19.647395 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m09:59:19.648394 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m09:59:19.654416 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:59:19.655412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF7D75CA0>]}
[0m09:59:19.656396 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m09:59:19.656396 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m09:59:19.657394 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:59:19.657394 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m09:59:19.657394 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m09:59:19.658395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m09:59:19.659394 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:59:19.660393 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.662394 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:59:19.673395 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.675395 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.675395 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m09:59:19.675395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:19.728583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:59:19.728583 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.729583 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:59:19.732583 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:59:19.738595 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.738595 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:59:19.739584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:59:19.740609 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.741596 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:59:19.742583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:19.753209 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:59:19.753209 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.753209 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m09:59:19.754209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:59:19.758210 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m09:59:19.760225 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m09:59:19.761208 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m09:59:19.778387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m09:59:19.780389 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m09:59:19.781389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF87030B0>]}
[0m09:59:19.781389 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m09:59:19.782388 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m09:59:19.782388 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m09:59:19.782388 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m09:59:19.783391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m09:59:19.783391 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m09:59:19.785388 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m09:59:19.786387 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m09:59:19.788387 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m09:59:19.789387 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:59:19.790388 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m09:59:19.790388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:19.844997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m09:59:19.844997 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m09:59:19.846022 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount 

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount 

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount 
,
sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id

) 
select * from order_payment_amount
  );
[0m09:59:19.846022 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "sum"
LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
         ^

[0m09:59:19.847017 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m09:59:19.847017 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m09:59:19.848997 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:59:19.848997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF8124500>]}
[0m09:59:19.849996 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m09:59:19.849996 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m09:59:19.849996 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:59:19.850997 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m09:59:19.850997 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m09:59:19.851996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m09:59:19.851996 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:59:19.853016 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.855117 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:59:19.856629 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.858628 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.858628 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m09:59:19.858628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:19.914181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m09:59:19.915206 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.915206 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m09:59:19.918182 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:59:19.920195 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.920195 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:59:19.921213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:59:19.922198 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:59:19.922198 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.922198 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m09:59:19.924210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:59:19.926195 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m09:59:19.927194 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m09:59:19.928194 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m09:59:19.928194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:59:19.929196 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m09:59:19.929196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd401e41f-074e-49aa-be94-78b2f7e46792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF69FBD10>]}
[0m09:59:19.930182 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:59:19.930182 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m09:59:19.931181 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:19.931181 [debug] [MainThread]: On master: BEGIN
[0m09:59:19.931181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:20.098308 [debug] [MainThread]: SQL status: BEGIN in 0.166 seconds
[0m09:59:20.099086 [debug] [MainThread]: On master: COMMIT
[0m09:59:20.099086 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:20.099604 [debug] [MainThread]: On master: COMMIT
[0m09:59:20.099604 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:59:20.100124 [debug] [MainThread]: On master: Close
[0m09:59:20.100124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:20.100643 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m09:59:20.100643 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m09:59:20.100643 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m09:59:20.101164 [info ] [MainThread]: 
[0m09:59:20.101684 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m09:59:20.102721 [debug] [MainThread]: Command end result
[0m09:59:20.115824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m09:59:20.118988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m09:59:20.123660 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m09:59:20.124185 [info ] [MainThread]: 
[0m09:59:20.124704 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:59:20.125214 [info ] [MainThread]: 
[0m09:59:20.125223 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near "count"
  LINE 15: count(case when  order_status='returned' then 1 else 0 end) ...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m09:59:20.125732 [info ] [MainThread]: 
[0m09:59:20.126250 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  syntax error at or near "sum"
  LINE 15: sum(case when payment_method='bank_transfer' then amount  en...
           ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m09:59:20.126767 [info ] [MainThread]: 
[0m09:59:20.127290 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m09:59:20.127807 [debug] [MainThread]: Command `dbt run` failed at 09:59:20.127807 after 2.05 seconds
[0m09:59:20.128315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF6B938F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF6B468D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF61D9580>]}
[0m09:59:20.128315 [debug] [MainThread]: Flushing usage events
[0m09:59:20.879617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:56.661817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2ABBC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2ABBF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2AB9BB0>]}


============================== 10:00:56.664830 | f10c5668-41c4-49c7-b48a-490500165de1 ==============================
[0m10:00:56.664830 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:00:56.665834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:00:56.869814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB01ACB00>]}
[0m10:00:56.914020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2F9EF00>]}
[0m10:00:56.915020 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:00:57.133027 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:00:57.256796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:00:57.257797 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m10:00:57.257797 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:00:57.431686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB4513410>]}
[0m10:00:57.467683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:00:57.483199 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:00:57.506551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB47C8DA0>]}
[0m10:00:57.506551 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:00:57.507538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB43BD9A0>]}
[0m10:00:57.508560 [info ] [MainThread]: 
[0m10:00:57.509539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:57.509539 [info ] [MainThread]: 
[0m10:00:57.509539 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:00:57.512539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:00:57.676231 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:00:57.676231 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:00:57.677231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:57.750231 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.073 seconds
[0m10:00:57.751243 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:00:57.752232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:00:57.788492 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:00:57.789490 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:00:57.789490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:57.845805 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m10:00:57.845805 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:00:57.846337 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:00:57.850163 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m10:00:57.851230 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:00:57.851230 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:00:57.854991 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:57.854991 [debug] [MainThread]: On master: BEGIN
[0m10:00:57.855502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:00:57.907856 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m10:00:57.907856 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:57.908855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:00:57.913855 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m10:00:57.914854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCAC7E4650>]}
[0m10:00:57.914854 [debug] [MainThread]: On master: ROLLBACK
[0m10:00:57.915854 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:57.915854 [debug] [MainThread]: On master: BEGIN
[0m10:00:57.915854 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:00:57.916854 [debug] [MainThread]: On master: COMMIT
[0m10:00:57.916854 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:57.916854 [debug] [MainThread]: On master: COMMIT
[0m10:00:57.916854 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:00:57.916854 [debug] [MainThread]: On master: Close
[0m10:00:57.921855 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:00:57.921855 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:00:57.922854 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:00:57.922854 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:00:57.927855 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:00:57.928854 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:00:57.952852 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:00:57.954853 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:00:57.954853 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:00:57.954853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:00:58.008046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m10:00:58.009045 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:00:58.009045 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count ,

count(case when  order_status='returned' then 1 else 0 end) as returned_count ,

count(case when  order_status='completed' then 1 else 0 end) as completed_count ,

count(case when  order_status='placed' then 1 else 0 end) as placed_count ,

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count ,

 count(*) as number_of_orders from dbt_postgres_etl.orders 
 
group by user_id
)
select * from customer_orders;
  );
[0m10:00:58.009045 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: select * from customer_orders;
                                      ^

[0m10:00:58.010046 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m10:00:58.010046 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:00:58.016062 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near ";"
  LINE 27: select * from customer_orders;
                                        ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:00:58.017059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB44516A0>]}
[0m10:00:58.018060 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m10:00:58.018060 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:00:58.019046 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:00:58.019046 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near ";"
  LINE 27: select * from customer_orders;
                                        ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m10:00:58.019046 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:00:58.020045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:00:58.020045 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:00:58.022065 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.023045 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:00:58.035045 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.037063 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.037125 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:00:58.037637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:58.091558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:00:58.091558 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.091558 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:00:58.095559 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:00:58.101559 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.101559 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:00:58.102559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:00:58.104571 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.104571 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:00:58.105558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:58.115557 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:00:58.115557 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.116557 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:00:58.117557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:00:58.120559 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:00:58.123558 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:00:58.123558 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:00:58.140557 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:00:58.142556 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:00:58.143557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB4ADEC30>]}
[0m10:00:58.143557 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m10:00:58.144556 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:00:58.144556 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:00:58.145558 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:00:58.145558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:00:58.145558 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:00:58.147557 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:00:58.149557 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:00:58.151558 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:00:58.153557 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:00:58.153557 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:00:58.153557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:58.207802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:00:58.208801 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:00:58.208801 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl.payments
group by order_id

) 
select * from order_payment_amount
  );
[0m10:00:58.209801 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_postgres_etl.payments" does not exist
LINE 20: from dbt_postgres_etl.payments
              ^

[0m10:00:58.209801 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m10:00:58.209801 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:00:58.211802 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl.payments
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m10:00:58.212802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB41C7A70>]}
[0m10:00:58.212802 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m10:00:58.213802 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:00:58.213802 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:00:58.214802 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl.payments
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m10:00:58.213802 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:00:58.214802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:00:58.214802 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:00:58.216817 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.217815 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:00:58.219801 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.221802 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.221802 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:00:58.221802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:58.276425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:00:58.277425 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.277425 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:00:58.280436 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:00:58.282425 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.282425 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:00:58.282425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:00:58.284457 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:00:58.284457 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.284457 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:00:58.285455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:00:58.286454 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:00:58.288467 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:00:58.289455 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:00:58.289455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:00:58.290454 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:00:58.290454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10c5668-41c4-49c7-b48a-490500165de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2F01760>]}
[0m10:00:58.291454 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:00:58.291454 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:00:58.292455 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:58.292455 [debug] [MainThread]: On master: BEGIN
[0m10:00:58.293454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:00:58.346080 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m10:00:58.347079 [debug] [MainThread]: On master: COMMIT
[0m10:00:58.347079 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:58.347079 [debug] [MainThread]: On master: COMMIT
[0m10:00:58.348080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:00:58.348080 [debug] [MainThread]: On master: Close
[0m10:00:58.348080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:58.348080 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:00:58.348080 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:00:58.349080 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:00:58.349080 [info ] [MainThread]: 
[0m10:00:58.349080 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m10:00:58.350079 [debug] [MainThread]: Command end result
[0m10:00:58.363080 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:00:58.366079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:00:58.370081 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:00:58.370081 [info ] [MainThread]: 
[0m10:00:58.371079 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:00:58.371079 [info ] [MainThread]: 
[0m10:00:58.371079 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near ";"
  LINE 27: select * from customer_orders;
                                        ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:00:58.372078 [info ] [MainThread]: 
[0m10:00:58.372078 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl.payments
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m10:00:58.373079 [info ] [MainThread]: 
[0m10:00:58.373079 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m10:00:58.374079 [debug] [MainThread]: Command `dbt run` failed at 10:00:58.374079 after 1.84 seconds
[0m10:00:58.374079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2516750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2F232F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB4697E30>]}
[0m10:00:58.374079 [debug] [MainThread]: Flushing usage events
[0m10:00:59.053712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:56.578415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A221319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A223D4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A223D4470>]}


============================== 10:01:56.582092 | ddf782c9-4f77-40e2-a4c5-44413b545a9e ==============================
[0m10:01:56.582092 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:01:56.582092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:01:56.782125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A1F98A8A0>]}
[0m10:01:56.825619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2367C500>]}
[0m10:01:56.826619 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:01:57.036315 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:01:57.159628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:01:57.159628 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m10:01:57.160646 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:01:57.336681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A23BE2360>]}
[0m10:01:57.370040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:01:57.383697 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:01:57.406146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A23D95040>]}
[0m10:01:57.407057 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:01:57.407057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A239805C0>]}
[0m10:01:57.408083 [info ] [MainThread]: 
[0m10:01:57.409287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:01:57.409774 [info ] [MainThread]: 
[0m10:01:57.410021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:01:57.413064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:01:57.577283 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:01:57.577283 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:01:57.578303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:57.653585 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.075 seconds
[0m10:01:57.654585 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:01:57.655585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:01:57.696789 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:01:57.697843 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:01:57.697843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:57.753790 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m10:01:57.753790 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:01:57.753790 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:01:57.758925 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m10:01:57.759973 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:01:57.760490 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:01:57.763634 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:57.764159 [debug] [MainThread]: On master: BEGIN
[0m10:01:57.764159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:57.820657 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m10:01:57.821719 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:57.821719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:01:57.826546 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m10:01:57.827196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A23C74AD0>]}
[0m10:01:57.828327 [debug] [MainThread]: On master: ROLLBACK
[0m10:01:57.828327 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:57.828327 [debug] [MainThread]: On master: BEGIN
[0m10:01:57.829326 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:01:57.829326 [debug] [MainThread]: On master: COMMIT
[0m10:01:57.829326 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:57.829326 [debug] [MainThread]: On master: COMMIT
[0m10:01:57.829326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:01:57.830324 [debug] [MainThread]: On master: Close
[0m10:01:57.834314 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:01:57.834314 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:01:57.835297 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:01:57.835297 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:01:57.839741 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:01:57.841083 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:01:57.859832 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:01:57.861299 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:01:57.861921 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:01:57.861921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:01:57.916301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:01:57.916942 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:01:57.917300 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count ,

count(case when  order_status='returned' then 1 else 0 end) as returned_count ,

count(case when  order_status='completed' then 1 else 0 end) as completed_count ,

count(case when  order_status='placed' then 1 else 0 end) as placed_count ,

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count ,

 count(*) as number_of_orders from dbt_postgres_etl."orders" 
 
group by user_id
)
select * from customer_orders;
  );
[0m10:01:57.917300 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: select * from customer_orders;
                                      ^

[0m10:01:57.918300 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m10:01:57.918300 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:01:57.923567 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near ";"
  LINE 27: select * from customer_orders;
                                        ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:01:57.925917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A23BBC680>]}
[0m10:01:57.926484 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m10:01:57.926817 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:01:57.927341 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:01:57.927341 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near ";"
  LINE 27: select * from customer_orders;
                                        ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m10:01:57.927906 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:01:57.929003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:01:57.929059 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:01:57.930784 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:57.932349 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:01:57.943935 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:57.945084 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:57.945639 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:01:57.945639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:57.999288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:01:58.000284 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:58.000284 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:01:58.004284 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:01:58.010242 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:58.010242 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:01:58.010848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:01:58.012641 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:58.012715 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:01:58.013845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:01:58.023293 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:01:58.023293 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:58.023293 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:01:58.025022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:01:58.029250 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:01:58.032168 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:01:58.032168 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:01:58.049517 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:01:58.051616 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:01:58.051616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A240B39B0>]}
[0m10:01:58.051616 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m10:01:58.052615 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:01:58.052615 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:01:58.053599 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:01:58.053599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:01:58.053599 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:01:58.056290 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:01:58.057289 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:01:58.059290 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:01:58.061087 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:01:58.061087 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:01:58.061611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:58.117375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m10:01:58.117892 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:01:58.117892 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl."payments"
group by order_id

) 
select * from order_payment_amount
  );
[0m10:01:58.118908 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_postgres_etl.payments" does not exist
LINE 20: from dbt_postgres_etl."payments"
              ^

[0m10:01:58.118908 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m10:01:58.118908 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:01:58.121549 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl."payments"
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m10:01:58.121549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A23AD4920>]}
[0m10:01:58.121549 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m10:01:58.122547 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:01:58.122547 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:01:58.123548 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl."payments"
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m10:01:58.123548 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:01:58.123548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:01:58.124546 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:01:58.125547 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.126563 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:01:58.129617 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.130659 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.131180 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:01:58.131180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:58.186616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:01:58.186616 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.186616 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:01:58.189616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:01:58.191616 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.191616 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:01:58.192601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:01:58.193751 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:01:58.193751 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.193751 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:01:58.195898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:01:58.196897 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:01:58.198898 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:01:58.198898 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:01:58.199897 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:01:58.199897 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:01:58.200897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf782c9-4f77-40e2-a4c5-44413b545a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A1F98A8A0>]}
[0m10:01:58.200897 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:01:58.201903 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:01:58.202683 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:58.202683 [debug] [MainThread]: On master: BEGIN
[0m10:01:58.203644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:01:58.258065 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m10:01:58.259064 [debug] [MainThread]: On master: COMMIT
[0m10:01:58.259064 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:58.259064 [debug] [MainThread]: On master: COMMIT
[0m10:01:58.260064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:01:58.260064 [debug] [MainThread]: On master: Close
[0m10:01:58.260064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:58.260064 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:01:58.260064 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:01:58.261064 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:01:58.261064 [info ] [MainThread]: 
[0m10:01:58.261064 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:01:58.262719 [debug] [MainThread]: Command end result
[0m10:01:58.273876 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:01:58.276891 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:01:58.281894 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:01:58.281894 [info ] [MainThread]: 
[0m10:01:58.281894 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:01:58.282891 [info ] [MainThread]: 
[0m10:01:58.282891 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  syntax error at or near ";"
  LINE 27: select * from customer_orders;
                                        ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:01:58.282891 [info ] [MainThread]: 
[0m10:01:58.283980 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl."payments"
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m10:01:58.284498 [info ] [MainThread]: 
[0m10:01:58.284498 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m10:01:58.285513 [debug] [MainThread]: Command `dbt run` failed at 10:01:58.285513 after 1.84 seconds
[0m10:01:58.285513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A22371280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A223724B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A217A16A0>]}
[0m10:01:58.285513 [debug] [MainThread]: Flushing usage events
[0m10:01:59.256923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:08.148142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE96006B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE9603EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE9600DD0>]}


============================== 10:25:08.151140 | cb8e1a67-7dea-4fd5-a555-799651e3e1b5 ==============================
[0m10:25:08.151140 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:25:08.152140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:08.359905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEA80AFC0>]}
[0m10:25:08.411571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE89B2420>]}
[0m10:25:08.413571 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:08.647140 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:25:08.769148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:08.769148 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:25:08.954056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEA8F3140>]}
[0m10:25:08.991681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:25:09.006352 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:25:09.031452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEAEE4DD0>]}
[0m10:25:09.031452 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:25:09.032527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEAB79CD0>]}
[0m10:25:09.033454 [info ] [MainThread]: 
[0m10:25:09.034516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:09.034516 [info ] [MainThread]: 
[0m10:25:09.034516 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:09.037186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:25:09.240191 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:25:09.240191 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:25:09.240191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:09.309355 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m10:25:09.310431 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:25:09.311428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:25:09.316461 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:25:09.317544 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:25:09.317544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:09.373988 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m10:25:09.373988 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:25:09.375038 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:25:09.380089 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m10:25:09.380741 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:25:09.380741 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:25:09.429459 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:09.430458 [debug] [MainThread]: On master: BEGIN
[0m10:25:09.431562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:09.496074 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m10:25:09.496074 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:09.497075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:09.502137 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m10:25:09.503132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE67FBDA0>]}
[0m10:25:09.503132 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:09.504135 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:09.504135 [debug] [MainThread]: On master: BEGIN
[0m10:25:09.504135 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:25:09.505155 [debug] [MainThread]: On master: COMMIT
[0m10:25:09.505286 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:09.505286 [debug] [MainThread]: On master: COMMIT
[0m10:25:09.505890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:25:09.505890 [debug] [MainThread]: On master: Close
[0m10:25:09.510684 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:25:09.510694 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:25:09.511379 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:25:09.511953 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:25:09.516026 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:25:09.517584 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:25:09.539332 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:25:09.541333 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:25:09.541333 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:25:09.541333 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:09.595097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m10:25:09.595097 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:25:09.595097 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count ,

count(case when  order_status='returned' then 1 else 0 end) as returned_count ,

count(case when  order_status='completed' then 1 else 0 end) as completed_count ,

count(case when  order_status='placed' then 1 else 0 end) as placed_count ,

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count ,

 count(*) as number_of_orders from dbt_postgres_etl."orders" 
 
group by user_id
)
select * from customer_orders
  );
[0m10:25:09.596099 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_postgres_etl.orders" does not exist
LINE 23:  count(*) as number_of_orders from dbt_postgres_etl."orders"...
                                            ^

[0m10:25:09.596099 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m10:25:09.597095 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:25:09.602836 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  relation "dbt_postgres_etl.orders" does not exist
  LINE 23:  count(*) as number_of_orders from dbt_postgres_etl."orders"...
                                              ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:25:09.603833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEAF10AA0>]}
[0m10:25:09.604833 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m10:25:09.604833 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:25:09.605837 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:25:09.606397 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  relation "dbt_postgres_etl.orders" does not exist
  LINE 23:  count(*) as number_of_orders from dbt_postgres_etl."orders"...
                                              ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m10:25:09.606397 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:25:09.607384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:25:09.607384 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:25:09.609399 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.610400 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:25:09.622097 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.624094 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.624094 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:25:09.624094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:25:09.680808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m10:25:09.680808 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.681791 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:25:09.684807 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:25:09.690807 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.691807 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:25:09.691807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:25:09.693807 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.693978 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:25:09.694497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:09.704497 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:25:09.704497 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.704497 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:25:09.705495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:25:09.710606 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:25:09.713436 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:25:09.714024 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:25:09.733001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m10:25:09.735002 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:25:09.735002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE95B27E0>]}
[0m10:25:09.736001 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.13s]
[0m10:25:09.737002 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:25:09.737182 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:25:09.737698 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:25:09.738245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:25:09.738245 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:25:09.740225 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:25:09.741013 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:25:09.743006 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:25:09.744006 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:25:09.745009 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:25:09.745009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:25:09.802904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m10:25:09.803919 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:25:09.803919 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl."payments"
group by order_id

) 
select * from order_payment_amount
  );
[0m10:25:09.804918 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_postgres_etl.payments" does not exist
LINE 20: from dbt_postgres_etl."payments"
              ^

[0m10:25:09.804918 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: ROLLBACK
[0m10:25:09.804918 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:25:09.807537 [debug] [Thread-1 (]: Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl."payments"
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m10:25:09.808066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEAC1D0A0>]}
[0m10:25:09.808066 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_payments ..................... [[31mERROR[0m in 0.07s]
[0m10:25:09.808639 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:25:09.809159 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:25:09.809159 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.order_payments' to be skipped because of status 'error'.  Reason: Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl."payments"
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql.
[0m10:25:09.809725 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:25:09.810297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:25:09.810297 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:25:09.812376 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.813616 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:25:09.816335 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.817574 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.817574 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:25:09.817574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:25:09.875320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m10:25:09.875320 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.876320 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:25:09.879986 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:25:09.882001 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.882001 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:25:09.882984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:25:09.882984 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:25:09.884000 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.884000 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:25:09.886002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:25:09.887000 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:25:09.888999 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:25:09.888999 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:25:09.888999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:25:09.889999 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:25:09.890999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8e1a67-7dea-4fd5-a555-799651e3e1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEA8E7920>]}
[0m10:25:09.890999 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:25:09.891986 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:25:09.892984 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:09.892984 [debug] [MainThread]: On master: BEGIN
[0m10:25:09.892984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:09.948061 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m10:25:09.949061 [debug] [MainThread]: On master: COMMIT
[0m10:25:09.949061 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:09.949061 [debug] [MainThread]: On master: COMMIT
[0m10:25:09.950045 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:25:09.950045 [debug] [MainThread]: On master: Close
[0m10:25:09.950045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:09.950045 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:25:09.951079 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:25:09.951079 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:25:09.951079 [info ] [MainThread]: 
[0m10:25:09.951079 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m10:25:09.952046 [debug] [MainThread]: Command end result
[0m10:25:09.965434 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:25:09.968452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:25:09.973664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:25:09.974213 [info ] [MainThread]: 
[0m10:25:09.974740 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:25:09.974740 [info ] [MainThread]: 
[0m10:25:09.975266 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  relation "dbt_postgres_etl.orders" does not exist
  LINE 23:  count(*) as number_of_orders from dbt_postgres_etl."orders"...
                                              ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:25:09.975787 [info ] [MainThread]: 
[0m10:25:09.976310 [error] [MainThread]:   Database Error in model order_payments (models\shop_data\order_payments.sql)
  relation "dbt_postgres_etl.payments" does not exist
  LINE 20: from dbt_postgres_etl."payments"
                ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\order_payments.sql
[0m10:25:09.976835 [info ] [MainThread]: 
[0m10:25:09.977362 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m10:25:09.977929 [debug] [MainThread]: Command `dbt run` failed at 10:25:09.977929 after 1.96 seconds
[0m10:25:09.978457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE8FD53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE91E90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE670DD00>]}
[0m10:25:09.978973 [debug] [MainThread]: Flushing usage events
[0m10:25:10.969759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:23.219039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE9D34140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEDAC6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEDC82600>]}


============================== 10:27:23.223050 | 9037e216-17ff-4235-9988-48012f926118 ==============================
[0m10:27:23.223050 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:27:23.223050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:23.421805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEC8002C0>]}
[0m10:27:23.467202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEDBC0D40>]}
[0m10:27:23.469202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:27:23.680860 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:27:23.804777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:27:23.805778 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\order_payments.sql
[0m10:27:23.805778 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:27:23.981907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEF430950>]}
[0m10:27:24.018118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:27:24.032647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:27:24.056212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEF6E8F20>]}
[0m10:27:24.056212 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:27:24.057212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEF532630>]}
[0m10:27:24.058213 [info ] [MainThread]: 
[0m10:27:24.058213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:24.058213 [info ] [MainThread]: 
[0m10:27:24.058213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:24.060784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:27:24.232081 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:27:24.232081 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:27:24.233081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:24.305301 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.073 seconds
[0m10:27:24.306330 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:27:24.307299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:27:24.351817 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:27:24.352816 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:27:24.352816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:24.407045 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m10:27:24.407045 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:27:24.407661 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:24.411690 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m10:27:24.411690 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:27:24.412691 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:27:24.415689 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:24.415689 [debug] [MainThread]: On master: BEGIN
[0m10:27:24.416690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:24.471686 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m10:27:24.471686 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:24.471686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:24.476686 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m10:27:24.477686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEDDAD9A0>]}
[0m10:27:24.477686 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:24.478687 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:24.478687 [debug] [MainThread]: On master: BEGIN
[0m10:27:24.478687 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:27:24.479685 [debug] [MainThread]: On master: COMMIT
[0m10:27:24.479685 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:24.479685 [debug] [MainThread]: On master: COMMIT
[0m10:27:24.479685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:27:24.479685 [debug] [MainThread]: On master: Close
[0m10:27:24.484258 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:27:24.485257 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:27:24.485257 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:27:24.486257 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:27:24.490257 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:27:24.491256 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:27:24.511254 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:27:24.512254 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:27:24.513254 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:27:24.513254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:24.568292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:27:24.568292 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:27:24.568292 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  order_status='return_pending' then 1 else 0 end) as return_pending_count ,

count(case when  order_status='returned' then 1 else 0 end) as returned_count ,

count(case when  order_status='completed' then 1 else 0 end) as completed_count ,

count(case when  order_status='placed' then 1 else 0 end) as placed_count ,

count(case when  order_status='shipped' then 1 else 0 end) as shipped_count ,

 count(*) as number_of_orders from dbt_postgres_etl."public"."orders" 
 
group by user_id
)
select * from customer_orders
  );
[0m10:27:24.569317 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_status" does not exist
LINE 13: count(case when  order_status='return_pending' then 1 else 0...
                          ^

[0m10:27:24.569317 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m10:27:24.570323 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:27:24.575291 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "order_status" does not exist
  LINE 13: count(case when  order_status='return_pending' then 1 else 0...
                            ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:27:24.577463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AED0CC0E0>]}
[0m10:27:24.577974 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m10:27:24.577974 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:27:24.578972 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:27:24.578972 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "order_status" does not exist
  LINE 13: count(case when  order_status='return_pending' then 1 else 0...
                            ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m10:27:24.578972 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:27:24.579972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:27:24.579972 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:27:24.581973 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.582973 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:27:24.594972 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.595972 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.596971 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:27:24.596971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:24.652190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:27:24.652190 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.652190 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:27:24.656188 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:27:24.662190 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.662190 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:27:24.663191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:27:24.665190 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.665190 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:27:24.666190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:24.677190 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:27:24.677190 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.677190 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:27:24.678190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:27:24.682190 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:27:24.684190 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:27:24.685190 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:27:24.701862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:27:24.703864 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:27:24.704864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEF9FA030>]}
[0m10:27:24.704864 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m10:27:24.705865 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:27:24.706867 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:27:24.706867 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:27:24.707864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:27:24.707864 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:27:24.709865 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.711866 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:27:24.713865 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.714863 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.714863 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:27:24.714863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:24.770118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:27:24.771227 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.771227 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl."public"."payments"
group by order_id

) 
select * from order_payment_amount
  );
[0m10:27:24.777780 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:27:24.779457 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.780016 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments__dbt_tmp" rename to "order_payments"
[0m10:27:24.780530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:27:24.781644 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:27:24.781644 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.782160 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:27:24.782679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:27:24.784227 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."order_payments__dbt_backup"
[0m10:27:24.786336 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:27:24.786336 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
drop view if exists "dbt_postgres_etl"."public"."order_payments__dbt_backup" cascade
[0m10:27:24.786882 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:27:24.787892 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:27:24.787892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEEF4A270>]}
[0m10:27:24.787892 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.order_payments ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:27:24.788872 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:27:24.788872 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:27:24.788872 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:27:24.789871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:27:24.789871 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:27:24.791870 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.792871 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:27:24.794870 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.795872 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.796898 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:27:24.797414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:24.850097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m10:27:24.850097 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.851122 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:27:24.854096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:27:24.856099 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.856099 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:27:24.856099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:27:24.857098 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:27:24.858100 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.858100 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:27:24.860098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:27:24.861117 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:27:24.862113 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:27:24.862113 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:27:24.862113 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:27:24.863097 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:27:24.864097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9037e216-17ff-4235-9988-48012f926118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AEFAB84D0>]}
[0m10:27:24.864097 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:27:24.864666 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:27:24.865607 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:24.865607 [debug] [MainThread]: On master: BEGIN
[0m10:27:24.865607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:24.919220 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m10:27:24.920220 [debug] [MainThread]: On master: COMMIT
[0m10:27:24.920220 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:24.920220 [debug] [MainThread]: On master: COMMIT
[0m10:27:24.921218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:27:24.921391 [debug] [MainThread]: On master: Close
[0m10:27:24.921903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:24.921903 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:27:24.921903 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:27:24.921903 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:27:24.921903 [info ] [MainThread]: 
[0m10:27:24.922900 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m10:27:24.923899 [debug] [MainThread]: Command end result
[0m10:27:24.934897 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:27:24.938037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:27:24.942014 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:27:24.943014 [info ] [MainThread]: 
[0m10:27:24.943014 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:27:24.944014 [info ] [MainThread]: 
[0m10:27:24.944014 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "order_status" does not exist
  LINE 13: count(case when  order_status='return_pending' then 1 else 0...
                            ^
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:27:24.944014 [info ] [MainThread]: 
[0m10:27:24.945013 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:27:24.945013 [debug] [MainThread]: Command `dbt run` failed at 10:27:24.945013 after 1.85 seconds
[0m10:27:24.946028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AED2CBE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AED9FA6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AED0CDFD0>]}
[0m10:27:24.946028 [debug] [MainThread]: Flushing usage events
[0m10:27:25.545531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:18.216668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE644321B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE63D4FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE643CF8C0>]}


============================== 10:29:18.219522 | c8244c45-503e-4853-841e-b948e9f7e318 ==============================
[0m10:29:18.219522 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:29:18.220531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:29:18.423170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE641DC1A0>]}
[0m10:29:18.467214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE63C33FB0>]}
[0m10:29:18.468214 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:29:18.681652 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:29:18.814127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:18.814646 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:29:18.985569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6570D220>]}
[0m10:29:19.020319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:29:19.035145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:29:19.059461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65E74E90>]}
[0m10:29:19.059461 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:29:19.059461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65AC8560>]}
[0m10:29:19.060369 [info ] [MainThread]: 
[0m10:29:19.061571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:19.062156 [info ] [MainThread]: 
[0m10:29:19.062156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:19.064252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:29:19.260996 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:29:19.260996 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:29:19.260996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:19.326995 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m10:29:19.327588 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:29:19.329279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:29:19.333295 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:29:19.333295 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:29:19.334278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:19.387958 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m10:29:19.388352 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:29:19.388352 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:19.392568 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:29:19.393304 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:29:19.393304 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:29:19.433696 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:19.433696 [debug] [MainThread]: On master: BEGIN
[0m10:29:19.433696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:19.598866 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m10:29:19.599430 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:19.599983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:19.604362 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m10:29:19.605376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE62FD86E0>]}
[0m10:29:19.605376 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:19.605376 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:19.606375 [debug] [MainThread]: On master: BEGIN
[0m10:29:19.606375 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:19.606375 [debug] [MainThread]: On master: COMMIT
[0m10:29:19.606375 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:19.606375 [debug] [MainThread]: On master: COMMIT
[0m10:29:19.607391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:19.607391 [debug] [MainThread]: On master: Close
[0m10:29:19.611362 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:29:19.611362 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:29:19.612360 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:29:19.612360 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:29:19.616375 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:29:19.617376 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:29:19.637061 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:29:19.638061 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:29:19.639047 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:29:19.639047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:19.693178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:29:19.693178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:29:19.693740 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

 count(*) as number_of_orders from dbt_postgres_etl."public"."orders" 
 
group by user_id
)
select * from customer_orders
  );
[0m10:29:19.694866 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "_count" specified more than once

[0m10:29:19.694866 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m10:29:19.695470 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:29:19.701085 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "_count" specified more than once
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:29:19.702737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65BBE4B0>]}
[0m10:29:19.703258 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m10:29:19.703777 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:29:19.704298 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:29:19.704816 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "_count" specified more than once
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m10:29:19.704816 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:29:19.705861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:29:19.705861 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:29:19.706983 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.708991 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:29:19.720654 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.721645 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.721645 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:29:19.721645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:19.775785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m10:29:19.775785 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.775785 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:29:19.779426 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:29:19.785422 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.785422 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:29:19.785422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:19.787428 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.787428 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:29:19.788427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:29:19.798094 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:29:19.798094 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.798707 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:29:19.799301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:19.803390 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:29:19.806121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:29:19.806121 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:29:19.824009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:29:19.825019 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:29:19.826005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6618E0C0>]}
[0m10:29:19.826005 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m10:29:19.827022 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:29:19.827022 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:29:19.828004 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:29:19.828004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:29:19.828004 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:29:19.830003 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.831021 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:29:19.833017 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.835019 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.835019 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:29:19.835019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:19.888333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:29:19.889351 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.889351 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl."public"."payments"
group by order_id

) 
select * from order_payment_amount
  );
[0m10:29:19.893999 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:29:19.895702 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.896263 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments" rename to "order_payments__dbt_backup"
[0m10:29:19.896263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:19.898008 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.898532 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments__dbt_tmp" rename to "order_payments"
[0m10:29:19.899098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:19.899664 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:29:19.900220 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.900261 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:29:19.901954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:29:19.903701 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."order_payments__dbt_backup"
[0m10:29:19.905402 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:29:19.905402 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
drop view if exists "dbt_postgres_etl"."public"."order_payments__dbt_backup" cascade
[0m10:29:19.907399 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:29:19.907399 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:29:19.908399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE657847A0>]}
[0m10:29:19.908399 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.order_payments ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:29:19.909399 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:29:19.909399 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:29:19.910399 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:29:19.910399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:29:19.910399 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:29:19.912399 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.913416 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:29:19.915425 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.917416 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.917416 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:29:19.917416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:19.972145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:29:19.972145 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.972145 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:29:19.975145 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:29:19.977199 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.977199 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:29:19.978198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:19.979199 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:29:19.979199 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.979199 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:29:19.981395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:29:19.983047 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:29:19.983607 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:29:19.983607 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:29:19.984177 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:29:19.984749 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:29:19.985312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8244c45-503e-4853-841e-b948e9f7e318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66199D60>]}
[0m10:29:19.985824 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:29:19.986408 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:29:19.987446 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:19.987500 [debug] [MainThread]: On master: BEGIN
[0m10:29:19.987500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:20.041436 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m10:29:20.041959 [debug] [MainThread]: On master: COMMIT
[0m10:29:20.041959 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:20.042484 [debug] [MainThread]: On master: COMMIT
[0m10:29:20.042484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:20.043050 [debug] [MainThread]: On master: Close
[0m10:29:20.043050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:20.043562 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:29:20.043562 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:29:20.043562 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:29:20.044083 [info ] [MainThread]: 
[0m10:29:20.044610 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m10:29:20.045133 [debug] [MainThread]: Command end result
[0m10:29:20.056396 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:29:20.059025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:29:20.062998 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:29:20.064001 [info ] [MainThread]: 
[0m10:29:20.064001 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:29:20.064001 [info ] [MainThread]: 
[0m10:29:20.064984 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "_count" specified more than once
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:29:20.064984 [info ] [MainThread]: 
[0m10:29:20.066006 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:29:20.066006 [debug] [MainThread]: Command `dbt run` failed at 10:29:20.066006 after 1.97 seconds
[0m10:29:20.067000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE63D4FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE64007080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65A17C50>]}
[0m10:29:20.067000 [debug] [MainThread]: Flushing usage events
[0m10:29:20.672967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:15.377942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561EA86660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561DECF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561EC22210>]}


============================== 10:32:15.381958 | 9bdcb194-3388-4d8f-852f-ec13fb3aa212 ==============================
[0m10:32:15.381958 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:32:15.381958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:32:15.583238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561FE99EE0>]}
[0m10:32:15.626612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561EA1D0D0>]}
[0m10:32:15.628117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:32:15.839360 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:32:15.960357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:32:15.960865 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:32:16.129591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561FF757C0>]}
[0m10:32:16.163860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:32:16.177877 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:32:16.201863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025620574AA0>]}
[0m10:32:16.201863 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:32:16.202861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256204172C0>]}
[0m10:32:16.203862 [info ] [MainThread]: 
[0m10:32:16.203862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:32:16.203862 [info ] [MainThread]: 
[0m10:32:16.204861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:32:16.206862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:32:16.368631 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:32:16.369148 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:32:16.369148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:16.433904 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m10:32:16.434933 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:32:16.436904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:32:16.440925 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:32:16.441917 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:32:16.441917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:16.497489 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m10:32:16.497489 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:32:16.497489 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:32:16.501488 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:32:16.502488 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:32:16.503487 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:32:16.540153 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:16.540153 [debug] [MainThread]: On master: BEGIN
[0m10:32:16.541153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:32:16.596140 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m10:32:16.596140 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:16.597164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:32:16.602151 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m10:32:16.603141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256204453D0>]}
[0m10:32:16.603141 [debug] [MainThread]: On master: ROLLBACK
[0m10:32:16.603141 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:16.603141 [debug] [MainThread]: On master: BEGIN
[0m10:32:16.604140 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:32:16.604140 [debug] [MainThread]: On master: COMMIT
[0m10:32:16.604140 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:16.604140 [debug] [MainThread]: On master: COMMIT
[0m10:32:16.605161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:32:16.605161 [debug] [MainThread]: On master: Close
[0m10:32:16.608762 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:32:16.609760 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:32:16.609760 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:32:16.610760 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:32:16.614761 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:32:16.615790 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:32:16.634758 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:32:16.636758 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:32:16.636758 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:32:16.636758 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:32:16.693052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m10:32:16.694052 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:32:16.694052 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

count(case when  status='' then 1 else 0 end) as _count ,

 count(*) as number_of_orders from dbt_postgres_etl."public"."orders" 
 
group by user_id
)
select * from customer_orders
  );
[0m10:32:16.695052 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "_count" specified more than once

[0m10:32:16.696052 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: ROLLBACK
[0m10:32:16.696052 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:32:16.702052 [debug] [Thread-1 (]: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "_count" specified more than once
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:32:16.704051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256207824E0>]}
[0m10:32:16.704051 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.customer_orders .................... [[31mERROR[0m in 0.09s]
[0m10:32:16.705053 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:32:16.705053 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:32:16.705053 [debug] [Thread-4 (]: Marking all children of 'model.postgres_dbt_analytics.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "_count" specified more than once
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql.
[0m10:32:16.706052 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:32:16.712209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:32:16.712209 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:32:16.714394 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.715971 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:32:16.727971 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.729736 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.730260 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:32:16.730260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:16.787936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m10:32:16.788933 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.788933 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:32:16.791943 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:32:16.797918 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.798918 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:32:16.798918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:32:16.800917 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.800917 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:32:16.801916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:32:16.811583 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:32:16.812141 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.812141 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:32:16.813188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:32:16.817961 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:32:16.820960 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:32:16.820960 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:32:16.838361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:32:16.839917 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:32:16.840484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561BCFB2F0>]}
[0m10:32:16.841000 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.13s]
[0m10:32:16.841529 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:32:16.842040 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:32:16.842053 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:32:16.842571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:32:16.843089 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:32:16.844800 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.845875 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:32:16.847971 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.848971 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.848971 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:32:16.848971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:16.903609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:32:16.904589 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.904589 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl."public"."payments"
group by order_id

) 
select * from order_payment_amount
  );
[0m10:32:16.908603 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:32:16.910592 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.910592 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments" rename to "order_payments__dbt_backup"
[0m10:32:16.911592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:32:16.912593 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.912593 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments__dbt_tmp" rename to "order_payments"
[0m10:32:16.913592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:32:16.914592 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:32:16.914592 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.914592 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:32:16.915600 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:32:16.916617 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."order_payments__dbt_backup"
[0m10:32:16.918599 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:32:16.919598 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
drop view if exists "dbt_postgres_etl"."public"."order_payments__dbt_backup" cascade
[0m10:32:16.920131 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:32:16.921114 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:32:16.922117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561FE9A5D0>]}
[0m10:32:16.922117 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.order_payments ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:32:16.923116 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:32:16.923116 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:32:16.923840 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:32:16.924368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:32:16.924888 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:32:16.926448 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.928013 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:32:16.930049 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.931050 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.931050 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:32:16.932050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:16.986112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:32:16.986624 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.987188 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:32:16.989938 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:32:16.991618 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.992179 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:32:16.992685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:32:16.993220 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:32:16.993788 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.993788 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:32:16.995498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:32:16.997102 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:32:16.997665 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:32:16.997665 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:32:16.998223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:32:16.998793 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:32:16.999318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdcb194-3388-4d8f-852f-ec13fb3aa212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025620951940>]}
[0m10:32:16.999835 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:32:16.999835 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:32:17.000832 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:17.001831 [debug] [MainThread]: On master: BEGIN
[0m10:32:17.001831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:32:17.055843 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m10:32:17.056780 [debug] [MainThread]: On master: COMMIT
[0m10:32:17.056780 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:17.056780 [debug] [MainThread]: On master: COMMIT
[0m10:32:17.057765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:32:17.057765 [debug] [MainThread]: On master: Close
[0m10:32:17.057765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:17.057765 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:32:17.058722 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:32:17.058722 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:32:17.058722 [info ] [MainThread]: 
[0m10:32:17.059721 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:32:17.059721 [debug] [MainThread]: Command end result
[0m10:32:17.071720 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:32:17.074721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:32:17.079239 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:32:17.079239 [info ] [MainThread]: 
[0m10:32:17.080242 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:32:17.080242 [info ] [MainThread]: 
[0m10:32:17.081238 [error] [MainThread]:   Database Error in model customer_orders (models\shop_data\customer_orders.sql)
  column "_count" specified more than once
  compiled code at target\run\postgres_dbt_analytics\models\shop_data\customer_orders.sql
[0m10:32:17.081238 [info ] [MainThread]: 
[0m10:32:17.082238 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:32:17.083239 [debug] [MainThread]: Command `dbt run` failed at 10:32:17.082238 after 1.83 seconds
[0m10:32:17.083239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561E938650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561EA86660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256205749B0>]}
[0m10:32:17.083239 [debug] [MainThread]: Flushing usage events
[0m10:32:17.771717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:10.402007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF3B2CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF5F43830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF5F41B80>]}


============================== 10:33:10.405006 | 4eba0714-63d6-424e-9caf-db75035a8bc1 ==============================
[0m10:33:10.405006 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:33:10.406098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Amadan\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Amadan\\dbt_jaffle_shop\\jaffle_shop_dbt\\postgres_dbt_analytics\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:33:10.604226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF6B62CF0>]}
[0m10:33:10.648288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF7C901A0>]}
[0m10:33:10.649286 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:10.861155 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:33:10.977878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:33:10.978878 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt_analytics://models\shop_data\customer_orders.sql
[0m10:33:11.161371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF3D9E540>]}
[0m10:33:11.195553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:33:11.210028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:33:11.233491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF83D4E30>]}
[0m10:33:11.233491 [info ] [MainThread]: Found 4 models, 4 data tests, 433 macros
[0m10:33:11.234331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF805F020>]}
[0m10:33:11.235326 [info ] [MainThread]: 
[0m10:33:11.235326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:11.236325 [info ] [MainThread]: 
[0m10:33:11.236325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:11.238923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl'
[0m10:33:11.398173 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl"
[0m10:33:11.399162 [debug] [ThreadPool]: On list_dbt_postgres_etl: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl"} */

    select distinct nspname from pg_namespace
  
[0m10:33:11.399162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:11.569463 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.170 seconds
[0m10:33:11.570463 [debug] [ThreadPool]: On list_dbt_postgres_etl: Close
[0m10:33:11.571447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_postgres_etl_public'
[0m10:33:11.575087 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:33:11.576102 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: BEGIN
[0m10:33:11.576102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:11.627288 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m10:33:11.628285 [debug] [ThreadPool]: Using postgres connection "list_dbt_postgres_etl_public"
[0m10:33:11.628285 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "list_dbt_postgres_etl_public"} */
select
      'dbt_postgres_etl' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_postgres_etl' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:33:11.632286 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:33:11.633286 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: ROLLBACK
[0m10:33:11.633286 [debug] [ThreadPool]: On list_dbt_postgres_etl_public: Close
[0m10:33:11.671130 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:11.671130 [debug] [MainThread]: On master: BEGIN
[0m10:33:11.672131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:11.725454 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m10:33:11.725454 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:11.726457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:11.731457 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m10:33:11.732493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF3D15D60>]}
[0m10:33:11.732612 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:11.733165 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:11.733165 [debug] [MainThread]: On master: BEGIN
[0m10:33:11.733165 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:33:11.733165 [debug] [MainThread]: On master: COMMIT
[0m10:33:11.734172 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:11.734172 [debug] [MainThread]: On master: COMMIT
[0m10:33:11.734172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:11.734172 [debug] [MainThread]: On master: Close
[0m10:33:11.738156 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.customer_orders
[0m10:33:11.738156 [info ] [Thread-1 (]: 1 of 4 START sql view model public.customer_orders ............................. [RUN]
[0m10:33:11.739171 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dbt_analytics.customer_orders'
[0m10:33:11.739171 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.customer_orders
[0m10:33:11.743839 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.745161 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.customer_orders
[0m10:33:11.765074 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.766119 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.766644 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: BEGIN
[0m10:33:11.767148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:11.822357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:33:11.822886 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.822886 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */

  create view "dbt_postgres_etl"."public"."customer_orders__dbt_tmp"
    
    
  as (
    


with customer_orders as (
select user_id,

count(case when  status='return_pending' then 1 else 0 end) as return_pending_count ,

count(case when  status='returned' then 1 else 0 end) as returned_count ,

count(case when  status='completed' then 1 else 0 end) as completed_count ,

count(case when  status='placed' then 1 else 0 end) as placed_count ,

count(case when  status='shipped' then 1 else 0 end) as shipped_count ,

 count(*) as number_of_orders from dbt_postgres_etl."public"."orders" 
 
group by user_id
)
select * from customer_orders
  );
[0m10:33:11.827709 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:33:11.831933 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.832463 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */
alter table "dbt_postgres_etl"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
[0m10:33:11.833025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:11.841471 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: COMMIT
[0m10:33:11.841471 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.842029 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: COMMIT
[0m10:33:11.843124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:11.846740 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."customer_orders__dbt_backup"
[0m10:33:11.850212 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.customer_orders"
[0m10:33:11.850212 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.customer_orders"} */
drop view if exists "dbt_postgres_etl"."public"."customer_orders__dbt_backup" cascade
[0m10:33:11.850796 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:11.852449 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.customer_orders: Close
[0m10:33:11.854085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF3ADFB90>]}
[0m10:33:11.854606 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.customer_orders ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m10:33:11.855131 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.customer_orders
[0m10:33:11.855645 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:33:11.856160 [info ] [Thread-1 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m10:33:11.856160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.customer_orders, now model.postgres_dbt_analytics.my_first_dbt_model)
[0m10:33:11.856784 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:33:11.858484 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.859638 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:33:11.871542 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.873153 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.873153 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: BEGIN
[0m10:33:11.873153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:11.933153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m10:33:11.933153 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.934153 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */

  
    

  create  table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:33:11.937169 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m10:33:11.942209 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.942209 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:33:11.943225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:11.945074 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.945200 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:33:11.946299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:11.948569 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:33:11.948569 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.949166 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: COMMIT
[0m10:33:11.949734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:11.951402 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup"
[0m10:33:11.953160 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_first_dbt_model"
[0m10:33:11.953160 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_first_dbt_model"} */
drop table if exists "dbt_postgres_etl"."public"."my_first_dbt_model__dbt_backup" cascade
[0m10:33:11.970482 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:33:11.971482 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_first_dbt_model: Close
[0m10:33:11.971482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF8733980>]}
[0m10:33:11.971482 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m10:33:11.972482 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_first_dbt_model
[0m10:33:11.973384 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.order_payments
[0m10:33:11.973907 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_payments .............................. [RUN]
[0m10:33:11.973968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.my_first_dbt_model, now model.postgres_dbt_analytics.order_payments)
[0m10:33:11.973968 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.order_payments
[0m10:33:11.976065 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.order_payments"
[0m10:33:11.977600 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.order_payments
[0m10:33:11.979595 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.order_payments"
[0m10:33:11.980595 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:33:11.980595 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: BEGIN
[0m10:33:11.980595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:12.036342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:33:12.036342 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:33:12.036342 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */

  create view "dbt_postgres_etl"."public"."order_payments__dbt_tmp"
    
    
  as (
    

with order_payment_amount as(

select order_id, 

sum(case when payment_method='credit_card' then amount  end ) as credit_card_amount,

sum(case when payment_method='bank_transfer' then amount  end ) as bank_transfer_amount,

sum(case when payment_method='gift_card' then amount  end ) as gift_card_amount,

sum(amount) as payment_amount
from dbt_postgres_etl."public"."payments"
group by order_id

) 
select * from order_payment_amount
  );
[0m10:33:12.041392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:33:12.043392 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:33:12.043392 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments" rename to "order_payments__dbt_backup"
[0m10:33:12.043392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:12.045392 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:33:12.045392 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
alter table "dbt_postgres_etl"."public"."order_payments__dbt_tmp" rename to "order_payments"
[0m10:33:12.046516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:12.047628 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:33:12.047690 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:33:12.047690 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: COMMIT
[0m10:33:12.049980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:12.051200 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."order_payments__dbt_backup"
[0m10:33:12.051720 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.order_payments"
[0m10:33:12.051720 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.order_payments"} */
drop view if exists "dbt_postgres_etl"."public"."order_payments__dbt_backup" cascade
[0m10:33:12.052914 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:12.054148 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.order_payments: Close
[0m10:33:12.054148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF8077B00>]}
[0m10:33:12.054773 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.order_payments ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:33:12.055884 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.order_payments
[0m10:33:12.055884 [debug] [Thread-1 (]: Began running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:33:12.056448 [info ] [Thread-1 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m10:33:12.056974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt_analytics.order_payments, now model.postgres_dbt_analytics.my_second_dbt_model)
[0m10:33:12.056974 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:33:12.058002 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.060018 [debug] [Thread-1 (]: Began executing node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:33:12.062014 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.063014 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.063014 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: BEGIN
[0m10:33:12.063014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:12.117933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:33:12.118456 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.118456 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */

  create view "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_postgres_etl"."public"."my_first_dbt_model"
where id = 1
  );
[0m10:33:12.121597 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:33:12.123682 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.124203 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
alter table "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:33:12.124722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:12.125293 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:33:12.125816 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.125816 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: COMMIT
[0m10:33:12.126893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:12.127985 [debug] [Thread-1 (]: Applying DROP to: "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup"
[0m10:33:12.128589 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt_analytics.my_second_dbt_model"
[0m10:33:12.128589 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "postgres_dbt_analytics", "target_name": "dev", "node_id": "model.postgres_dbt_analytics.my_second_dbt_model"} */
drop view if exists "dbt_postgres_etl"."public"."my_second_dbt_model__dbt_backup" cascade
[0m10:33:12.129588 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:12.130589 [debug] [Thread-1 (]: On model.postgres_dbt_analytics.my_second_dbt_model: Close
[0m10:33:12.131609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eba0714-63d6-424e-9caf-db75035a8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF87C0860>]}
[0m10:33:12.131609 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:33:12.132588 [debug] [Thread-1 (]: Finished running node model.postgres_dbt_analytics.my_second_dbt_model
[0m10:33:12.133589 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:12.133589 [debug] [MainThread]: On master: BEGIN
[0m10:33:12.133589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:12.186550 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m10:33:12.186550 [debug] [MainThread]: On master: COMMIT
[0m10:33:12.187550 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:12.187550 [debug] [MainThread]: On master: COMMIT
[0m10:33:12.187550 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:12.187550 [debug] [MainThread]: On master: Close
[0m10:33:12.188550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:12.188550 [debug] [MainThread]: Connection 'list_dbt_postgres_etl' was properly closed.
[0m10:33:12.188550 [debug] [MainThread]: Connection 'list_dbt_postgres_etl_public' was properly closed.
[0m10:33:12.188550 [debug] [MainThread]: Connection 'model.postgres_dbt_analytics.my_second_dbt_model' was properly closed.
[0m10:33:12.188550 [info ] [MainThread]: 
[0m10:33:12.189550 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m10:33:12.190562 [debug] [MainThread]: Command end result
[0m10:33:12.201098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\manifest.json
[0m10:33:12.204093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\semantic_manifest.json
[0m10:33:12.207703 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Amadan\dbt_jaffle_shop\jaffle_shop_dbt\postgres_dbt_analytics\target\run_results.json
[0m10:33:12.207703 [info ] [MainThread]: 
[0m10:33:12.208701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:12.208701 [info ] [MainThread]: 
[0m10:33:12.209702 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:33:12.210752 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:12.209702 after 1.93 seconds
[0m10:33:12.210752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF69E8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF5E29E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EF83D51F0>]}
[0m10:33:12.210752 [debug] [MainThread]: Flushing usage events
[0m10:33:12.785960 [debug] [MainThread]: An error was encountered while trying to flush usage events
